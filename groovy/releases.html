
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>GeoScript Groovy Releases &#8212; GeoScript Groovy</title>
    <link rel="stylesheet" href="_static/geoscript.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Maven Quickstart" href="mavenapp.html" />
    <link rel="prev" title="Downloads" href="download.html" />
    <script src="_static/site.js"></script>
    <script src="_static/jquery.cookie.js"></script>
    <script>site.setLanguage('groovy')</script>
    
    

  </head><body>
    <div class="header">
        <div class="wrap">
            <h1 id="logo" class="logo-groovy"><a href="..">GeoScript</a></h1>
            <ul id="top-nav">
                <li class="first"><a href="index.html">Groovy</a></li>
                <li><a href="quickstart.html">Quick Start</a></li>
                <li><a href="api/index.html">API</a></li>
                <li><a href="../js/index.html">JavaScript</a></li>
                <li><a href="../py/index.html">Python</a></li>
                <li><a href="../scala/index.html">Scala</a></li>
            </ul>
            <div id="searchbox">
                <form class="search" action="search.html" method="get">
                    <input id="searchbox-query" type="text" name="q" size="25" value="Search &hellip;" tabindex="3" onblur="if(this.value=='') this.value='Search &hellip;';" onfocus="if(this.value=='Search &hellip;') this.value='';" />
                    <input id="searchbox-submit" type="image" value="Search" src="_static/img/search_icon_green.png" />
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                </form>
            </div>
        </div>
    </div>


      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">GeoScript Groovy Releases</a><ul>
<li><a class="reference internal" href="#id1">1.14.0</a></li>
<li><a class="reference internal" href="#id2">1.13.0</a></li>
<li><a class="reference internal" href="#id3">1.12.0</a></li>
<li><a class="reference internal" href="#id4">1.11.0</a></li>
<li><a class="reference internal" href="#id5">1.10.0</a></li>
<li><a class="reference internal" href="#id6">1.9.0</a></li>
<li><a class="reference internal" href="#id7">1.8.0</a></li>
<li><a class="reference internal" href="#id8">1.7.0</a></li>
<li><a class="reference internal" href="#id9">1.6.0</a></li>
<li><a class="reference internal" href="#id10">1.5.0</a></li>
<li><a class="reference internal" href="#id11">1.4.0</a></li>
<li><a class="reference internal" href="#id12">1.3.1</a></li>
<li><a class="reference internal" href="#id13">1.3</a></li>
<li><a class="reference internal" href="#id14">1.2</a></li>
<li><a class="reference internal" href="#id15">1.1.1</a></li>
<li><a class="reference internal" href="#id16">1.1</a></li>
<li><a class="reference internal" href="#id17">1.0</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="download.html"
                        title="previous chapter">Downloads</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mavenapp.html"
                        title="next chapter">Maven Quickstart</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="geoscript-groovy-releases">
<span id="releases"></span><h1>GeoScript Groovy Releases<a class="headerlink" href="#geoscript-groovy-releases" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>1.14.0<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The 1.14 release of GeoScript is build on Groovy 2.5.8, GeoTools 22.0, and the Java Topology Suite 1.16.1 and requires Java 8.</p>
<p>The SpatiaLite Workspace in now based on OGR.</p>
<p>Added a Geometry TWKB Reader.</p>
<p>Set user agent for OSM tile requests.</p>
<p>Added a LineString and MultiLineString createPointsAlong(double distance) method.</p>
<p>Fixed WMSLayer getBounds method.</p>
<p>Added Band.getDescription() method.</p>
<p>Added an example for creating a geopackage database from natural earth data.</p>
<p>Added an example for creating a MBTiles file from natural earth data.</p>
</div>
<div class="section" id="id2">
<h2>1.13.0<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>The 1.13 release of GeoScript is built on Groovy 2.5.6, GeoTools 21.0, and the Java Topology Suite 1.16.0 and requires Java 8.</p>
<p>Added a Raster mosaic method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Raster</span> <span class="n">mosaicedRaster</span> <span class="o">=</span> <span class="n">Raster</span><span class="o">.</span><span class="n">mosaic</span><span class="p">([</span><span class="n">raster1</span><span class="p">,</span> <span class="n">raster2</span><span class="p">,</span> <span class="n">raster3</span><span class="p">])</span>
</pre></div>
</div>
<p>Add metatile support to the Tile generator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TMS</span> <span class="n">tms</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TMS</span><span class="p">(</span><span class="s2">&quot;world&quot;</span><span class="p">,</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">pyramid</span><span class="p">)</span>
<span class="n">TileRenderer</span> <span class="n">renderer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ImageTileRenderer</span><span class="p">(</span><span class="n">tms</span><span class="p">,</span> <span class="p">[</span><span class="n">ocean</span><span class="p">,</span> <span class="n">countries</span><span class="p">])</span>
<span class="n">TileGenerator</span> <span class="n">generator</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TileGenerator</span><span class="p">(</span><span class="n">verbose</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
<span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">tms</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">metatile</span><span class="p">:</span> <span class="p">[</span><span class="n">width</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<p>Updates due to GeoTools Java 11 refactoring.</p>
<p>Fixed Raster getValueAsString method.</p>
<p>Fixed all usages of Filter.intersects to include geometry name</p>
<p>Improved CSV reading when semi-colon is a part of the name.</p>
</div>
<div class="section" id="id3">
<h2>1.12.0<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>The 1.12 release of GeoScript is built on Groovy 2.4.15, GeoTools 20.0, and the Java Topology Suite 1.16.0 and
requires Java 8.</p>
<p>Update JTS to 1.16.0</p>
<p>Switch jiffle from jaitools to geosolutions.</p>
<p>Switch to si.uon.SI.</p>
<p>Calculate a hillshade from a Relief:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.GeoTIFF</span>
<span class="kn">import</span> <span class="nn">geoscript.layer.Raster</span>
<span class="kn">import</span> <span class="nn">geoscript.render.Draw</span>

<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;mt_rainier.tif&quot;</span><span class="p">)</span>
<span class="n">GeoTIFF</span> <span class="n">geoTIFF</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">geoTIFF</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">Raster</span> <span class="n">shadedReliefRaster</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">createShadedRelief</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">260</span><span class="p">)</span>
<span class="n">File</span> <span class="n">outFile</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;mt_rainier_shadedrelief.tif&quot;</span><span class="p">)</span>
<span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="n">outFile</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">shadedReliefRaster</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">shadedReliefRaster</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;mt_rainier_map.png&quot;</span><span class="p">),</span> <span class="n">size</span><span class="p">:</span> <span class="p">[</span><span class="mi">800</span><span class="p">,</span><span class="mi">400</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/hillshade.png" src="_images/hillshade.png" />
<p>Create Band with a description and min and max values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Band</span> <span class="n">band</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Band</span><span class="p">(</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>
</pre></div>
</div>
<p>Create Band with a description and min and max values and no data value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Band</span> <span class="n">band</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Band</span><span class="p">(</span><span class="s2">&quot;Elevation&quot;</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a Raster with bounds, size, and a List of Bands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Raster</span><span class="p">(</span>
        <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
        <span class="mi">400</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span>
        <span class="p">[</span>
                <span class="n">new</span> <span class="n">Band</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span>
                <span class="n">new</span> <span class="n">Band</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span>
                <span class="n">new</span> <span class="n">Band</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Add an example for creating a new Raster and setting random values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.filter.Color</span>
<span class="kn">import</span> <span class="nn">geoscript.geom.Bounds</span>
<span class="kn">import</span> <span class="nn">geoscript.layer.Band</span>
<span class="kn">import</span> <span class="nn">geoscript.layer.GeoTIFF</span>
<span class="kn">import</span> <span class="nn">geoscript.layer.Raster</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">Raster</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Raster</span><span class="p">(</span>
        <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
        <span class="mi">400</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span>
        <span class="p">[</span>
                <span class="n">new</span> <span class="n">Band</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span>
                <span class="n">new</span> <span class="n">Band</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span>
                <span class="n">new</span> <span class="n">Band</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="p">]</span>
<span class="p">)</span>

<span class="o">//</span> <span class="n">Set</span> <span class="n">values</span> <span class="n">of</span> <span class="n">each</span> <span class="n">pixel</span>
<span class="n">raster</span><span class="o">.</span><span class="n">eachCell</span> <span class="p">{</span> <span class="n">double</span> <span class="n">value</span><span class="p">,</span> <span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">double</span> <span class="n">y</span> <span class="o">-&gt;</span>
    <span class="n">Color</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="n">randomPastel</span>
    <span class="n">raster</span><span class="o">.</span><span class="n">setValue</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="n">color</span><span class="o">.</span><span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">raster</span><span class="o">.</span><span class="n">setValue</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="n">color</span><span class="o">.</span><span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">raster</span><span class="o">.</span><span class="n">setValue</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="n">color</span><span class="o">.</span><span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">Write</span> <span class="n">the</span> <span class="n">Raster</span> <span class="n">to</span> <span class="n">disk</span>
<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;random.tif&quot;</span><span class="p">)</span>
<span class="n">GeoTIFF</span> <span class="n">geotiff</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">geotiff</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/random_raster.png" src="_images/random_raster.png" />
<p>Add getMinValue and getMaxValue to Raster.  Both methods first tries to get the value from the Band’s metadata
and then calculates it from the actual data.</p>
<p>Viewer.plot should handle closing the Window like other viewers.</p>
<p>Add data label option the Scatter plot.</p>
<p>Calling Geometry.validReason on a valid geometry should return an empty string.</p>
</div>
<div class="section" id="id4">
<h2>1.11.0<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>The 1.11 release of GeoScript is built on Groovy 2.4.14, GeoTools 19.0, and the Java Topology Suite 1.13 and
requires Java 8.</p>
<p>Add support for storing PBF vector tiles in MBTiles database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;world.mbtiles&quot;</span><span class="p">)</span>

<span class="n">Pyramid</span> <span class="n">pyramid</span> <span class="o">=</span> <span class="n">Pyramid</span><span class="o">.</span><span class="n">createGlobalMercatorPyramid</span><span class="p">()</span>
<span class="n">pyramid</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">Pyramid</span><span class="o">.</span><span class="n">Origin</span><span class="o">.</span><span class="n">TOP_LEFT</span>
<span class="n">VectorTiles</span> <span class="n">vectorTiles</span> <span class="o">=</span> <span class="n">new</span> <span class="n">VectorTiles</span><span class="p">(</span>
    <span class="s2">&quot;world&quot;</span><span class="p">,</span>
    <span class="n">file</span><span class="p">,</span>
    <span class="n">pyramid</span><span class="p">,</span>
    <span class="s2">&quot;pbf&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Fix getting values from Rasters with short values.</p>
<p>Set the name when creating DBTiles.</p>
<p>Add tile counts and min and max zoom level methods to DBTiles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DBTiles</span> <span class="n">dbtiles</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DBTiles</span><span class="p">(</span><span class="s2">&quot;jdbc:sqlite:$</span><span class="si">{dbFile}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;org.sqlite.JDBC&quot;</span><span class="p">)</span>
<span class="n">List</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">dbtiles</span><span class="o">.</span><span class="n">tileCounts</span>
<span class="n">stats</span><span class="o">.</span><span class="n">eachWithIndex</span> <span class="p">{</span> <span class="n">Map</span> <span class="n">stat</span><span class="p">,</span> <span class="nb">int</span> <span class="n">index</span> <span class="o">-&gt;</span>
    <span class="n">println</span> <span class="n">stat</span><span class="o">.</span><span class="n">zoom</span>
    <span class="n">println</span> <span class="n">stat</span><span class="o">.</span><span class="n">tiles</span>
    <span class="n">println</span> <span class="n">stat</span><span class="o">.</span><span class="n">total</span>
    <span class="n">println</span> <span class="n">stat</span><span class="o">.</span><span class="n">percent</span>
<span class="p">}</span>

<span class="n">println</span> <span class="n">dbtiles</span><span class="o">.</span><span class="n">minZoom</span>
<span class="n">println</span> <span class="n">dbtiles</span><span class="o">.</span><span class="n">maxZoom</span>
</pre></div>
</div>
<p>Add getMetadata method to DBTiles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DBTiles</span> <span class="n">dbtiles</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DBTiles</span><span class="p">(</span><span class="s2">&quot;jdbc:sqlite:$</span><span class="si">{dbFile}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;org.sqlite.JDBC&quot;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">dbtiles</span><span class="o">.</span><span class="n">metadata</span>
<span class="n">println</span> <span class="n">metadata</span><span class="o">.</span><span class="n">name</span>
<span class="n">println</span> <span class="n">metadata</span><span class="o">.</span><span class="n">type</span>
<span class="n">println</span> <span class="n">metadata</span><span class="o">.</span><span class="n">version</span>
<span class="n">println</span> <span class="n">metadata</span><span class="o">.</span><span class="n">description</span>
<span class="n">println</span> <span class="n">metadata</span><span class="o">.</span><span class="n">format</span>
<span class="n">println</span> <span class="n">metadata</span><span class="o">.</span><span class="n">bounds</span>
<span class="n">println</span> <span class="n">metadata</span><span class="o">.</span><span class="n">attribution</span>
</pre></div>
</div>
<p>Improve PBF VectorTile reading and writing.</p>
<p>Add mercator top left wellknown pyramid name.</p>
<p>Add pretty print option to geojson writing.</p>
<p>Include the gt-epsg-extension GeoTools Library to support more projections:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Projection</span> <span class="n">proj</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;EPSG:104905&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Add a Filter.equals method to create a Filter where a Property equals some Literal value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span> <span class="nb">filter</span> <span class="o">=</span> <span class="n">Filter</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span> <span class="s2">&quot;Washington&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The GeoScript.unzip method now correctly unzips nested directories.</p>
<p>The SimpleStyleReader correctly applies stroke and fill attributes when a shape is specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.geom.</span><span class="o">*</span>
<span class="kn">import</span> <span class="nn">geoscript.layer.Layer</span>
<span class="kn">import</span> <span class="nn">geoscript.workspace.</span><span class="o">*</span>
<span class="kn">import</span> <span class="nn">geoscript.feature.Schema</span>
<span class="kn">import</span> <span class="nn">geoscript.render.Map</span> <span class="k">as</span> <span class="nn">GMap</span>
<span class="kn">import</span> <span class="nn">geoscript.style.io.SimpleStyleReader</span>

<span class="n">Bounds</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
<span class="n">MultiPoint</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Geometry</span><span class="o">.</span><span class="n">createRandomPoints</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">Workspace</span> <span class="n">workspace</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Memory</span><span class="p">()</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">workspace</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">new</span> <span class="n">Schema</span><span class="p">(</span><span class="s2">&quot;points&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;geom&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">]]))</span>
<span class="n">points</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span>
    <span class="n">layer</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">geom</span><span class="p">:</span> <span class="n">it</span><span class="p">])</span>
<span class="p">}</span>
<span class="n">layer</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">SimpleStyleReader</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;stroke=black fill=blue shape-type=star shape-size=14&quot;</span><span class="p">)</span>

<span class="n">GMap</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GMap</span><span class="p">(</span><span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">])</span>
<span class="nb">map</span><span class="o">.</span><span class="n">renderToImage</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/simple_style_read_shape.png" src="_images/simple_style_read_shape.png" />
<p>Add a UniqueValuesReader for reading text files that contain a color per value.  Very useful when styling geologic maps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.Layer</span>
<span class="kn">import</span> <span class="nn">geoscript.layer.Shapefile</span>
<span class="kn">import</span> <span class="nn">geoscript.render.Map</span>
<span class="kn">import</span> <span class="nn">geoscript.style.io.UniqueValuesReader</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">geoscript</span><span class="o">.</span><span class="n">GeoScript</span><span class="o">.</span><span class="n">download</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">geoscript</span><span class="o">.</span><span class="n">GeoScript</span><span class="o">.</span><span class="n">unzip</span>

<span class="n">File</span> <span class="nb">dir</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;mars&quot;</span><span class="p">)</span>
<span class="nb">dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>

<span class="n">unzip</span><span class="p">(</span>
    <span class="n">download</span><span class="p">(</span><span class="n">new</span> <span class="n">URL</span><span class="p">(</span><span class="s2">&quot;https://astropedia.astrogeology.usgs.gov/download/Mars/Geology/Mars15MGeologicGISRenovation.zip&quot;</span><span class="p">),</span>
             <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="s2">&quot;mars.zip&quot;</span><span class="p">),</span> <span class="n">overwrite</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;mars/I1802ABC_Mars_global_geology/Shapefiles/I1802ABC_Mars2000_Sphere/geo_units_oc_dd.shp&quot;</span><span class="p">)</span>

<span class="n">UniqueValuesReader</span> <span class="n">styleReader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">UniqueValuesReader</span><span class="p">(</span><span class="s2">&quot;UnitSymbol&quot;</span><span class="p">,</span> <span class="s2">&quot;polygon&quot;</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">styleReader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;mars/I1802ABC_Mars_global_geology/I1802ABC_geo_units_RGBlut.txt&quot;</span><span class="p">))</span>

<span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">])</span>
<span class="nb">map</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;mars_geology.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/mars_geology.png" src="_images/mars_geology.png" />
</div>
<div class="section" id="id5">
<h2>1.10.0<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>The 1.10.0 release of GeoScript is built on Grooovy 2.4.12, GeoTools 18.0, and the Java Topology Suite 1.13 and
requires Java 8.</p>
<p>A Sqlite Workspace based on the OGR non-spatialite Sqlite format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sqlite</span> <span class="n">sqlite</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Sqlite</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;naturalearth&quot;</span><span class="p">))</span>
<span class="n">Layer</span> <span class="n">countries</span> <span class="o">=</span> <span class="n">sqlite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;countries&quot;</span><span class="p">)</span>
<span class="n">Layer</span> <span class="n">ocean</span> <span class="o">=</span> <span class="n">sqlite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ocean&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Read and Write Geometry in the GeoPackage format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoPackageReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoPackageReader</span><span class="p">()</span>
<span class="n">String</span> <span class="n">hexString</span> <span class="o">=</span> <span class="s2">&quot;4750000200000000405bc00000000000405bc00000000000c047800000000000c0478000000000000000000001405bc00000000000c047800000000000&quot;</span>
<span class="n">Point</span> <span class="n">point</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hexString</span><span class="p">)</span>
<span class="n">println</span> <span class="n">point</span>
<span class="n">POINT</span> <span class="p">(</span><span class="mi">111</span> <span class="mi">047</span><span class="p">)</span>

<span class="n">GeoPackageWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoPackageWriter</span><span class="p">()</span>
<span class="n">Point</span> <span class="n">p</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="o">-</span><span class="mi">47</span><span class="p">)</span>
<span class="n">String</span> <span class="n">hexString</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">println</span> <span class="n">hexString</span>
<span class="mi">4750000200000000405</span><span class="n">bc00000000000405bc00000000000c047800000000000c0478000000000000000000001405bc00000000000c047800000000000</span>
</pre></div>
</div>
<p>Store tiles in any JDBC database (like H2, Postgres, or SQLite) in the familiar MBTiles format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.</span><span class="o">*</span>
<span class="kn">import</span> <span class="nn">geoscript.style.io.SimpleStyleReader</span>
<span class="kn">import</span> <span class="nn">javax.imageio.ImageIO</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">geoscript</span><span class="o">.</span><span class="n">GeoScript</span><span class="o">.</span><span class="n">download</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">geoscript</span><span class="o">.</span><span class="n">GeoScript</span><span class="o">.</span><span class="n">unzip</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">directory</span> <span class="n">fo</span>
<span class="n">File</span> <span class="nb">dir</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;dbtiles&quot;</span><span class="p">)</span>
<span class="nb">dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>

<span class="o">//</span> <span class="n">Download</span> <span class="n">data</span> <span class="kn">from</span> <span class="nn">natural</span> <span class="n">earth</span>
<span class="n">File</span> <span class="n">shpDir</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;naturalearth&quot;</span><span class="p">)</span>
<span class="p">[</span>
        <span class="p">[</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;countries&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="s2">&quot;http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/cultural/ne_110m_admin_0_countries.zip&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;ocean&quot;</span><span class="p">,</span>     <span class="n">url</span><span class="p">:</span> <span class="s2">&quot;http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/physical/ne_110m_ocean.zip&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="n">Map</span> <span class="n">item</span> <span class="o">-&gt;</span>
    <span class="n">unzip</span><span class="p">(</span><span class="n">download</span><span class="p">(</span><span class="n">new</span> <span class="n">URL</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">url</span><span class="p">),</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="n">shpDir</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="si">{item.name}</span><span class="s2">.zip&quot;</span><span class="p">),</span> <span class="n">overwrite</span><span class="p">:</span> <span class="n">false</span><span class="p">))</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">Use</span> <span class="n">simple</span> <span class="n">style</span> <span class="n">reader</span> <span class="n">to</span> <span class="n">create</span> <span class="n">styles</span>
<span class="n">SimpleStyleReader</span> <span class="n">styleReader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">SimpleStyleReader</span><span class="p">()</span>

<span class="o">//</span> <span class="n">Get</span> <span class="n">Layers</span> <span class="ow">and</span> <span class="n">their</span> <span class="n">styles</span>
<span class="n">Layer</span> <span class="n">ocean</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;naturalearth/ne_110m_ocean.shp&quot;</span><span class="p">)</span>
<span class="n">ocean</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">styleReader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;fill=#88caf8&quot;</span><span class="p">)</span>

<span class="n">Layer</span> <span class="n">countries</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;naturalearth/ne_110m_admin_0_countries.shp&quot;</span><span class="p">)</span>
<span class="n">countries</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">styleReader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;stroke=black stroke-width=0.5 fill=white&quot;</span><span class="p">)</span>

<span class="o">//</span> <span class="n">DBTiles</span> <span class="k">with</span> <span class="n">h2</span>
<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;world.db&quot;</span><span class="p">)</span>
<span class="n">DBTiles</span> <span class="n">dbtiles</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DBTiles</span><span class="p">(</span><span class="s2">&quot;jdbc:h2:$</span><span class="si">{file}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;org.h2.Driver&quot;</span><span class="p">,</span> <span class="s2">&quot;World&quot;</span><span class="p">,</span> <span class="s2">&quot;A map of the world&quot;</span><span class="p">)</span>

<span class="n">TileRenderer</span> <span class="n">renderer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ImageTileRenderer</span><span class="p">(</span><span class="n">dbtiles</span><span class="p">,</span> <span class="p">[</span><span class="n">ocean</span><span class="p">,</span> <span class="n">countries</span><span class="p">])</span>
<span class="n">TileGenerator</span> <span class="n">generator</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TileGenerator</span><span class="p">(</span><span class="n">verbose</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
<span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dbtiles</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="p">(</span><span class="mf">0.</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">each</span><span class="p">{</span><span class="nb">int</span> <span class="n">zoom</span> <span class="o">-&gt;</span>
    <span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">dbtiles</span><span class="o">.</span><span class="n">getRaster</span><span class="p">(</span><span class="n">dbtiles</span><span class="o">.</span><span class="n">tiles</span><span class="p">(</span><span class="n">zoom</span><span class="p">))</span>
    <span class="n">ImageIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raster</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="s2">&quot;h2_$</span><span class="si">{zoom}</span><span class="s2">.png&quot;</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">dbtiles</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/h2_1.png" src="_images/h2_1.png" />
<p>The Label Symbolizer now has a strikethrough property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">statesShp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span>
<span class="n">statesShp</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#E6E6E6&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;#4C4C4C&quot;</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">new</span> <span class="n">Shape</span><span class="p">(</span><span class="s2">&quot;#66CCff&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;circle&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">stroke</span><span class="p">(</span><span class="s2">&quot;#004080&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Transform</span><span class="p">(</span><span class="s2">&quot;centroid(the_geom)&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">zindex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">new</span> <span class="n">Label</span><span class="p">(</span><span class="s2">&quot;STATE_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strikethrough</span><span class="p">(</span><span class="n">true</span><span class="p">)</span><span class="o">.</span><span class="n">font</span><span class="p">(</span><span class="n">new</span> <span class="n">Font</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;serif&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#004080&quot;</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="n">bounds</span><span class="p">:</span> <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="o">-</span><span class="mf">114.675293</span><span class="p">,</span><span class="mf">37.317752</span><span class="p">,</span><span class="o">-</span><span class="mf">83.078613</span><span class="p">,</span><span class="mf">49.210420</span><span class="p">,</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
    <span class="n">fixAspectRatio</span><span class="p">:</span> <span class="n">true</span>
<span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">proj</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
<span class="nb">map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">statesShp</span><span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states_label_strikethrough.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/states_label_strikethrough.png" src="_images/states_label_strikethrough.png" />
<p>The Label Symbolizer now has wordSpacing and characterSpacing properties:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">statesShp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span>
<span class="n">statesShp</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#E6E6E6&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;#4C4C4C&quot;</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">new</span> <span class="n">Shape</span><span class="p">(</span><span class="s2">&quot;#66CCff&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;circle&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">stroke</span><span class="p">(</span><span class="s2">&quot;#004080&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Transform</span><span class="p">(</span><span class="s2">&quot;centroid(the_geom)&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">zindex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">new</span> <span class="n">Label</span><span class="p">(</span><span class="s2">&quot;STATE_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">wordSpacing</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">characterSpacing</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">font</span><span class="p">(</span><span class="n">new</span> <span class="n">Font</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;serif&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#004080&quot;</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="n">bounds</span><span class="p">:</span> <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="o">-</span><span class="mf">114.675293</span><span class="p">,</span><span class="mf">37.317752</span><span class="p">,</span><span class="o">-</span><span class="mf">83.078613</span><span class="p">,</span><span class="mf">49.210420</span><span class="p">,</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
    <span class="n">fixAspectRatio</span><span class="p">:</span> <span class="n">true</span>
<span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">proj</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
<span class="nb">map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">statesShp</span><span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states_label_spacing.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/states_label_spacing.png" src="_images/states_label_spacing.png" />
<p>Create a map cube using the gnomonic cube sphere projection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MapCube</span> <span class="n">mapCube</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MapCube</span><span class="p">(</span><span class="n">title</span><span class="p">:</span> <span class="s2">&quot;The Earth Map Cube&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="s2">&quot;Natural Earth&quot;</span><span class="p">,</span> <span class="n">drawOutline</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
<span class="n">mapCube</span><span class="o">.</span><span class="n">render</span><span class="p">([</span><span class="n">ocean</span><span class="p">,</span> <span class="n">countries</span><span class="p">],</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;map_cube.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/map_cube.png" src="_images/map_cube.png" />
<p>Generate a grid with triangles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Bounds</span> <span class="n">b</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getGrid</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot;triangle&quot;</span><span class="p">),</span> <span class="n">out</span><span class="p">:</span> <span class="s2">&quot;triangles.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/triangles.png" src="_images/triangles.png" />
<p>Several methods were added to the Color class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Color</span> <span class="n">c</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;#6495ED&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Darken:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">darken</span><span class="p">(</span><span class="mf">0.50</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_darken.png" src="_images/color_darken.png" />
<p>Lighten:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">lighten</span><span class="p">(</span><span class="mf">0.20</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_lighten.png" src="_images/color_lighten.png" />
<p>Constrast:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">contrast</span><span class="p">(</span><span class="n">new</span> <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;navy&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">),</span> <span class="mf">0.20</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_contrast.png" src="_images/color_contrast.png" />
<p>Desaturate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">desaturate</span><span class="p">(</span><span class="mf">0.33</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_desaturate.png" src="_images/color_desaturate.png" />
<p>Saturate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">saturate</span><span class="p">(</span><span class="mf">0.33</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_saturate.png" src="_images/color_saturate.png" />
<p>Grayscale:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">grayscale</span><span class="p">(</span><span class="mf">0.45</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_grayscale.png" src="_images/color_grayscale.png" />
<p>Mix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">mix</span><span class="p">(</span><span class="n">new</span> <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;wheat&quot;</span><span class="p">),</span> <span class="mf">0.15</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_mix.png" src="_images/color_mix.png" />
<p>Shade:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">shade</span><span class="p">(</span><span class="mf">0.45</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_shade.png" src="_images/color_shade.png" />
<p>Spin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="mf">0.61</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_spin.png" src="_images/color_spin.png" />
<p>Tint:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">tint</span><span class="p">(</span><span class="mf">0.10</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/color_tint.png" src="_images/color_tint.png" />
</div>
<div class="section" id="id6">
<h2>1.9.0<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>The 1.9.0 release of GeoScript is built on Grooovy 2.4.10, GeoTools 17.0, and the Java Topology Suite 1.13 and
requires Java 8.</p>
<p>Alot of work went into improving documentation.</p>
<p>Javadocs are now published online.</p>
<p><a class="reference external" href="http://geoscript.github.io/geoscript-groovy/api/1.9.0/index.html">http://geoscript.github.io/geoscript-groovy/api/1.9.0/index.html</a></p>
<p>And a GeoScript Groovy Cookbook is slowly but surely adding simple recipes.</p>
<p><a class="reference external" href="https://jericks.github.io/geoscript-groovy-cookbook/index.html">https://jericks.github.io/geoscript-groovy-cookbook/index.html</a></p>
<p><a class="reference external" href="https://jericks.github.io/geoscript-groovy-cookbook/index.pdf">https://jericks.github.io/geoscript-groovy-cookbook/index.pdf</a></p>
<blockquote>
<div><p>The Label Symbolizer now has an underline method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.Shapefile</span>
<span class="kn">import</span> <span class="nn">geoscript.render.Map</span>
<span class="kn">import</span> <span class="nn">geoscript.style.</span><span class="o">*</span>

<span class="k">def</span> <span class="nf">statesShp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span>
<span class="n">statesShp</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#E6E6E6&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;#4C4C4C&quot;</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">new</span> <span class="n">Shape</span><span class="p">(</span><span class="s2">&quot;#66CCff&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;circle&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">stroke</span><span class="p">(</span><span class="s2">&quot;#004080&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Transform</span><span class="p">(</span><span class="s2">&quot;centroid(the_geom)&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">zindex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">new</span> <span class="n">Label</span><span class="p">(</span><span class="s2">&quot;STATE_ABBR&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">underline</span><span class="p">(</span><span class="n">true</span><span class="p">)</span><span class="o">.</span><span class="n">font</span><span class="p">(</span><span class="n">new</span> <span class="n">Font</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;serif&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#004080&quot;</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">width</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span> <span class="n">fixAspectRatio</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">proj</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
<span class="nb">map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">statesShp</span><span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">statesShp</span><span class="o">.</span><span class="n">bounds</span>
<span class="nb">map</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states_underline.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/states_underline.png" src="_images/states_underline.png" />
<p>Add support for the WagnerV projection as a well known name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Projection</span> <span class="n">proj</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;WagnerV&quot;</span><span class="p">)</span>
<span class="n">println</span> <span class="n">proj</span>
</pre></div>
</div>
<p>Create Colors with rgb and hsl function syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Color</span> <span class="n">color1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;rgb(255,0,255)&quot;</span><span class="p">)</span>
<span class="n">Color</span> <span class="n">color2</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Color</span><span class="p">(</span><span class="s2">&quot;hsl(0,1,0.5)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Raster can pretty print values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Format</span> <span class="nb">format</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="s2">&quot;earth.tif&quot;</span><span class="p">)</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">println</span> <span class="n">raster</span><span class="o">.</span><span class="n">getValuesAsString</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

  <span class="mf">0.100</span>   <span class="mf">0.450</span>   <span class="mf">0.193</span>   <span class="mf">0.200</span>  <span class="mf">12.456</span>   <span class="mf">0.200</span>   <span class="mf">0.000</span>
  <span class="mf">0.100</span>   <span class="mf">1.450</span>   <span class="mf">1.193</span>   <span class="mf">1.200</span> <span class="mf">112.456</span>   <span class="mf">1.200</span>   <span class="mf">0.000</span>
  <span class="mf">0.100</span>   <span class="mf">1.450</span>   <span class="mf">2.193</span>   <span class="mf">3.200</span> <span class="mf">212.456</span>   <span class="mf">1.200</span>   <span class="mf">0.000</span>
  <span class="mf">0.100</span>   <span class="mf">1.450</span>   <span class="mf">1.193</span>   <span class="mf">1.200</span> <span class="mf">112.456</span>   <span class="mf">1.200</span>   <span class="mf">0.000</span>
  <span class="mf">0.100</span>   <span class="mf">0.450</span>   <span class="mf">0.193</span>   <span class="mf">0.200</span>  <span class="mf">12.456</span>   <span class="mf">0.200</span>   <span class="mf">0.000</span>

<span class="n">println</span> <span class="n">raster</span><span class="o">.</span><span class="n">getValuesAsString</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">prettyPrint</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>

  <span class="o">-----------------------------------------------------------------------</span>
  <span class="o">|</span>   <span class="mf">0.100</span> <span class="o">|</span>   <span class="mf">0.450</span> <span class="o">|</span>   <span class="mf">0.193</span> <span class="o">|</span>   <span class="mf">0.200</span> <span class="o">|</span>  <span class="mf">12.456</span> <span class="o">|</span>   <span class="mf">0.200</span> <span class="o">|</span>   <span class="mf">0.000</span> <span class="o">|</span>
  <span class="o">-----------------------------------------------------------------------</span>
  <span class="o">|</span>   <span class="mf">0.100</span> <span class="o">|</span>   <span class="mf">1.450</span> <span class="o">|</span>   <span class="mf">1.193</span> <span class="o">|</span>   <span class="mf">1.200</span> <span class="o">|</span> <span class="mf">112.456</span> <span class="o">|</span>   <span class="mf">1.200</span> <span class="o">|</span>   <span class="mf">0.000</span> <span class="o">|</span>
  <span class="o">-----------------------------------------------------------------------</span>
  <span class="o">|</span>   <span class="mf">0.100</span> <span class="o">|</span>   <span class="mf">1.450</span> <span class="o">|</span>   <span class="mf">2.193</span> <span class="o">|</span>   <span class="mf">3.200</span> <span class="o">|</span> <span class="mf">212.456</span> <span class="o">|</span>   <span class="mf">1.200</span> <span class="o">|</span>   <span class="mf">0.000</span> <span class="o">|</span>
  <span class="o">-----------------------------------------------------------------------</span>
  <span class="o">|</span>   <span class="mf">0.100</span> <span class="o">|</span>   <span class="mf">1.450</span> <span class="o">|</span>   <span class="mf">1.193</span> <span class="o">|</span>   <span class="mf">1.200</span> <span class="o">|</span> <span class="mf">112.456</span> <span class="o">|</span>   <span class="mf">1.200</span> <span class="o">|</span>   <span class="mf">0.000</span> <span class="o">|</span>
  <span class="o">-----------------------------------------------------------------------</span>
  <span class="o">|</span>   <span class="mf">0.100</span> <span class="o">|</span>   <span class="mf">0.450</span> <span class="o">|</span>   <span class="mf">0.193</span> <span class="o">|</span>   <span class="mf">0.200</span> <span class="o">|</span>  <span class="mf">12.456</span> <span class="o">|</span>   <span class="mf">0.200</span> <span class="o">|</span>   <span class="mf">0.000</span> <span class="o">|</span>
  <span class="o">-----------------------------------------------------------------------</span>
</pre></div>
</div>
<p>SLDWriter has optional named parameters for the number of spaces to use while indenting and
whether to export default values or not:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Symbolizer sym = new Fill(&quot;wheat&quot;) + new Stroke(&quot;brown&quot;)
SLDWriter writer = new SLDWriter()
String sld = writer.write(sym, exportDefaultValues: true, indentation: 4)
println sld

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;sld:StyledLayerDescriptor xmlns=&quot;http://www.opengis.net/sld&quot; xmlns:sld=&quot;http://www.opengis.net/sld&quot; xmlns:ogc=&quot;http://www.opengis.net/ogc&quot; xmlns:gml=&quot;http://www.opengis.net/gml&quot; version=&quot;1.0.0&quot;&gt;
    &lt;sld:UserLayer&gt;
        &lt;sld:LayerFeatureConstraints&gt;
            &lt;sld:FeatureTypeConstraint/&gt;
        &lt;/sld:LayerFeatureConstraints&gt;
        &lt;sld:UserStyle&gt;
            &lt;sld:Name&gt;Default Styler&lt;/sld:Name&gt;
            &lt;sld:FeatureTypeStyle&gt;
                &lt;sld:Name&gt;name&lt;/sld:Name&gt;
                &lt;sld:Rule&gt;
                    &lt;sld:PolygonSymbolizer&gt;
                        &lt;sld:Fill&gt;
                            &lt;sld:CssParameter name=&quot;fill&quot;&gt;#f5deb3&lt;/sld:CssParameter&gt;
                            &lt;sld:CssParameter name=&quot;fill-opacity&quot;&gt;1.0&lt;/sld:CssParameter&gt;
                        &lt;/sld:Fill&gt;
                    &lt;/sld:PolygonSymbolizer&gt;
                    &lt;sld:LineSymbolizer&gt;
                        &lt;sld:Stroke&gt;
                            &lt;sld:CssParameter name=&quot;stroke&quot;&gt;#a52a2a&lt;/sld:CssParameter&gt;
                            &lt;sld:CssParameter name=&quot;stroke-linecap&quot;&gt;butt&lt;/sld:CssParameter&gt;
                            &lt;sld:CssParameter name=&quot;stroke-linejoin&quot;&gt;miter&lt;/sld:CssParameter&gt;
                            &lt;sld:CssParameter name=&quot;stroke-opacity&quot;&gt;1.0&lt;/sld:CssParameter&gt;
                            &lt;sld:CssParameter name=&quot;stroke-width&quot;&gt;1&lt;/sld:CssParameter&gt;
                            &lt;sld:CssParameter name=&quot;stroke-dashoffset&quot;&gt;0.0&lt;/sld:CssParameter&gt;
                        &lt;/sld:Stroke&gt;
                    &lt;/sld:LineSymbolizer&gt;
                &lt;/sld:Rule&gt;
            &lt;/sld:FeatureTypeStyle&gt;
        &lt;/sld:UserStyle&gt;
    &lt;/sld:UserLayer&gt;
&lt;/sld:StyledLayerDescriptor&gt;
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="id7">
<h2>1.8.0<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>The 1.8.0 release of GeoScript is built on Grooovy 2.4.7, GeoTools 16.0, and the Java Topology Suite 1.13 and
requires Java 8.</p>
<blockquote>
<div><p>Create Projections using well known names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;WGS84&quot;</span><span class="p">)</span>
<span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;Mollweide&quot;</span><span class="p">)</span>
<span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;WagnerIV&quot;</span><span class="p">)</span>
<span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;WorldVanderGrintenI&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a Raster from Tiles around a Point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">osm</span><span class="o">.</span><span class="n">getRaster</span><span class="p">(</span>
    <span class="n">Projection</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Geometry</span><span class="o">.</span><span class="n">fromWKT</span><span class="p">(</span><span class="n">wkt</span><span class="p">),</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="s2">&quot;EPSG:3857&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">Point</span><span class="p">,</span>
    <span class="n">z</span><span class="p">,</span>
    <span class="mi">400</span><span class="p">,</span>
    <span class="mi">400</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Create a Directory Workspace from a zipped shapefile URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Directory</span> <span class="nb">dir</span> <span class="o">=</span> <span class="n">Directory</span><span class="o">.</span><span class="n">fromURL</span><span class="p">(</span>
  <span class="n">new</span> <span class="n">URL</span><span class="p">(</span><span class="s2">&quot;http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/cultural/ne_110m_admin_0_countries.zip&quot;</span><span class="p">),</span>
  <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;naturalearth&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Added a getTileCoordinates() method to the Pyramid class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyramid</span> <span class="n">pyramid</span> <span class="o">=</span> <span class="n">Pyramid</span><span class="o">.</span><span class="n">createGlobalMercatorPyramid</span><span class="p">()</span>
<span class="n">Bounds</span> <span class="n">b</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span>
    <span class="o">-</span><span class="mf">124.73142200000001</span><span class="p">,</span>
    <span class="mf">24.955967</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">66.969849</span><span class="p">,</span>
    <span class="mf">49.371735</span><span class="p">,</span>
    <span class="s2">&quot;EPSG:4326&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">)</span>
<span class="n">Map</span> <span class="n">coords</span> <span class="o">=</span> <span class="n">pyramid</span><span class="o">.</span><span class="n">getTileCoordinates</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">pyramid</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<p>Added getDataSource() method to the Database Workspace.</p>
<p>Added Stamen’s Terrain layer to the OSM.getWellKnownOSM() method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TileLayer</span><span class="o">.</span><span class="n">getTileLayer</span><span class="p">([</span><span class="nb">type</span><span class="p">:</span> <span class="s1">&#39;osm&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;stamen-terrain&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>GeoPackage.delete() method removes a GeoPackage Tile Layer.</p>
<p>Added Filter.id() and Filter.ids() methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span> <span class="nb">filter</span> <span class="o">=</span> <span class="n">Filter</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="s2">&quot;points.1&quot;</span><span class="p">)</span>
<span class="n">Filter</span> <span class="nb">filter</span> <span class="o">=</span> <span class="n">Filter</span><span class="o">.</span><span class="n">ids</span><span class="p">([</span><span class="s2">&quot;points.1&quot;</span><span class="p">,</span><span class="s2">&quot;points.2&quot;</span><span class="p">,</span><span class="s2">&quot;points.3&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Added XmlSchemaReader and XmlSchemaWriter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;schema&gt;</span>
<span class="s2">    &lt;name&gt;points&lt;/name&gt;</span>
<span class="s2">    &lt;projection&gt;EPSG:4326&lt;/projection&gt;</span>
<span class="s2">    &lt;geometry&gt;geom&lt;/geometry&gt;</span>
<span class="s2">    &lt;fields&gt;</span>
<span class="s2">    &lt;field&gt;</span>
<span class="s2">      &lt;name&gt;geom&lt;/name&gt;</span>
<span class="s2">      &lt;type&gt;Point&lt;/type&gt;</span>
<span class="s2">      &lt;projection&gt;EPSG:4326&lt;/projection&gt;</span>
<span class="s2">    &lt;/field&gt;</span>
<span class="s2">    &lt;field&gt;</span>
<span class="s2">      &lt;name&gt;name&lt;/name&gt;</span>
<span class="s2">      &lt;type&gt;String&lt;/type&gt;</span>
<span class="s2">    &lt;/field&gt;</span>
<span class="s2">    &lt;field&gt;</span>
<span class="s2">      &lt;name&gt;price&lt;/name&gt;</span>
<span class="s2">      &lt;type&gt;Float&lt;/type&gt;</span>
<span class="s2">    &lt;/field&gt;</span>
<span class="s2">    &lt;/fields&gt;</span>
<span class="s2">    &lt;/schema&gt;&quot;&quot;&quot;</span>
<span class="n">SchemaReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">XmlSchemaReader</span><span class="p">()</span>
<span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
<p>Fixed Raster.eachCell so it visits every cell.</p>
<p>Added normalize and convolve methods to Raster.</p>
<p>Added getMinZoom() and getMaxZoom() methods to GeoPackage TileLayer.</p>
</div></blockquote>
</div>
<div class="section" id="id8">
<h2>1.7.0<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.7.0 release of GeoScript is built on Grooovy 2.4.6, GeoTools 15.0, and the Java Topology Suite 1.13 and
requires Java 8.</p>
<p>This version focused on making GeoScript more modular and extensible.  GeoScript is more extensible by
providing Service Provider Interface (SPI) end points for Readers, Writer, Formats, TileLayers and Workspaces.
GeoScript is more modular by using Groovy’s Extension Modules to add methods dynamically.</p>
<p>Most of the other features of 1.7 were contributed by the community (thank you sbortman, blackrez, and gnafu)
or driven by the development of <a class="reference external" href="https://github.com/jericks/geoc">geoc</a> (a geospatial commandline application),
<a class="reference external" href="https://github.com/jericks/geo-shell">geo-shell</a> (an interactive shell for geospatial analysis),
and <a class="reference external" href="https://github.com/jericks/MBTilesServer">MBTilesServer</a> (a Spring Boot based web app for serving
MBtiles maps).</p>
<p><strong>Tile</strong></p>
<p>MBTiles got methods to access metdata and minimum and maximum zoom levels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MBTiles</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MBTiles</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.mbtiles&quot;</span><span class="p">))</span>
<span class="n">println</span> <span class="n">layer</span><span class="o">.</span><span class="n">metadata</span>
<span class="n">println</span> <span class="n">layer</span><span class="o">.</span><span class="n">minZoom</span>
<span class="n">println</span> <span class="n">layer</span><span class="o">.</span><span class="n">maxZoom</span>
</pre></div>
</div>
<p>GeoPackage and MBTiles both got a new getTileCount() method that returns statistics on the number of tiles present
per zoom level:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoPackage</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoPackage</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.gpkg&quot;</span><span class="p">),</span> <span class="s2">&quot;states&quot;</span><span class="p">)</span>
<span class="n">List</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">tileCounts</span>
<span class="n">stats</span><span class="o">.</span><span class="n">eachWithIndex</span> <span class="p">{</span> <span class="n">Map</span> <span class="n">stat</span><span class="p">,</span> <span class="nb">int</span> <span class="n">index</span> <span class="o">-&gt;</span>
    <span class="n">println</span> <span class="s2">&quot;$</span><span class="si">{index}</span><span class="s2">). $</span><span class="si">{stat.zoom}</span><span class="s2"> $</span><span class="si">{stat.tiles}</span><span class="s2"> $</span><span class="si">{stat.total}</span><span class="s2"> $</span><span class="si">{stat.percent}</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The Tile module got a new TileLayer called GeneratingTileLayer that can generate Tiles on demand:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;wheat&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">folder</span><span class="o">.</span><span class="n">newFile</span><span class="p">(</span><span class="s2">&quot;states.mbtiles&quot;</span><span class="p">)</span>
<span class="n">TileLayer</span> <span class="n">tileLayer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MBTiles</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.mbtiles&quot;</span><span class="p">),</span> <span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="s2">&quot;A map of the united states&quot;</span><span class="p">)</span>
<span class="n">ImageTileRenderer</span> <span class="n">tileRenderer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ImageTileRenderer</span><span class="p">(</span><span class="n">tileLayer</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span>
<span class="n">GeneratingTileLayer</span> <span class="n">generatingTileLayer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeneratingTileLayer</span><span class="p">(</span><span class="n">tileLayer</span><span class="p">,</span> <span class="n">tileRenderer</span><span class="p">)</span>
</pre></div>
</div>
<p>The ImageTileLayer base class now makes sure that the Bounds passed to the getRaster() method
is in the correct projection.</p>
<p>Finally, the OSM TileLayer has a static method for creating TileLayers with well known OSM based web serivces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OSM</span><span class="o">.</span><span class="n">getWellKnownOSM</span><span class="p">(</span><span class="s2">&quot;osm&quot;</span><span class="p">)</span>
<span class="n">OSM</span><span class="o">.</span><span class="n">getWellKnownOSM</span><span class="p">(</span><span class="s2">&quot;stamen-toner&quot;</span><span class="p">)</span>
<span class="n">OSM</span><span class="o">.</span><span class="n">getWellKnownOSM</span><span class="p">(</span><span class="s2">&quot;stamen-toner&quot;</span><span class="p">)</span>
<span class="n">OSM</span><span class="o">.</span><span class="n">getWellKnownOSM</span><span class="p">(</span><span class="s2">&quot;stamen-toner-lite&quot;</span><span class="p">)</span>
<span class="n">OSM</span><span class="o">.</span><span class="n">getWellKnownOSM</span><span class="p">(</span><span class="s2">&quot;stamen-watercolor&quot;</span><span class="p">)</span>
<span class="n">OSM</span><span class="o">.</span><span class="n">getWellKnownOSM</span><span class="p">(</span><span class="s2">&quot;mapquest-street&quot;</span><span class="p">)</span>
<span class="n">OSM</span><span class="o">.</span><span class="n">getWellKnownOSM</span><span class="p">(</span><span class="s2">&quot;mapquest-satellite&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Style</strong></p>
<p>The Style module added a YSLD Reader and Writer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Symbolizer</span> <span class="n">sym</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;wheat&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;brown&quot;</span><span class="p">)</span>
<span class="n">YSLDWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">YSLDWriter</span><span class="p">()</span>
<span class="n">String</span> <span class="n">yaml</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
</pre></div>
</div>
<p>The Style module also got a new SimpleStyleReader that can easily create simple styles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SimpleStyleReader</span> <span class="n">styleReader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">SimpleStyleReader</span><span class="p">()</span>
<span class="o">//</span> <span class="n">Fill</span> <span class="ow">and</span> <span class="n">Stroke</span>
<span class="n">Style</span> <span class="n">style</span> <span class="o">=</span> <span class="n">styleReader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;fill=#555555 fill-opacity=0.6 stroke=#555555 stroke-width=0.5&quot;</span><span class="p">)</span>
<span class="o">//</span> <span class="n">Shape</span> <span class="k">with</span> <span class="n">Fill</span> <span class="ow">and</span> <span class="n">Stroke</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">styleReader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;fill=navy stroke=yellow shape-type=circle&quot;</span><span class="p">)</span>
<span class="o">//</span> <span class="n">Shape</span> <span class="k">with</span> <span class="n">Fill</span> <span class="ow">and</span> <span class="n">Stroke</span> <span class="k">with</span> <span class="n">Label</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">styleReader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;fill=#554466 stroke=255,255,0 shape-type=triangle label=NAME label-size=12&quot;</span><span class="p">)</span>
<span class="o">//</span> <span class="n">Just</span> <span class="n">fill</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">styleReader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;fill=#554466&quot;</span><span class="p">)</span>
<span class="o">//</span> <span class="n">Just</span> <span class="n">stroke</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">styleReader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;stroke=#554466&quot;</span><span class="p">)</span>
<span class="o">//</span> <span class="n">Just</span> <span class="n">shape</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">styleReader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;shape=#554466&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This version also updated default style and inherited a perpendicular offset for Strokes from the GeoTools project.</p>
<p><strong>Renderer</strong></p>
<p>sbortman added a new GeoTIFF Renderer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">))</span>
<span class="n">layer</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">],</span> <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">GeoTIFF</span> <span class="n">geotiff</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">img</span> <span class="o">=</span> <span class="n">geotiff</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
</pre></div>
</div>
<p>Users can now configure MapWindow and Window’s do when the ui is closed (hide, exit, dispose):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:[</span><span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)])</span>
<span class="n">Window</span> <span class="n">window</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Window</span><span class="p">()</span>
<span class="n">window</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="nb">map</span><span class="p">,</span> <span class="n">close</span><span class="p">:</span> <span class="s1">&#39;hide&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The Map now guards against null projections in Bounds.</p>
<p><strong>Geometry</strong></p>
<p>The Geometry IO package received a Google Polygon Encoder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GooglePolylineEncoder</span> <span class="n">encoder</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GooglePolylineEncoder</span><span class="p">()</span>
<span class="n">LineString</span> <span class="n">lineString</span> <span class="o">=</span> <span class="n">new</span> <span class="n">LineString</span><span class="p">([</span><span class="o">-</span><span class="mf">120.2</span><span class="p">,</span> <span class="mf">38.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">120.95</span><span class="p">,</span> <span class="mf">40.7</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">126.453</span><span class="p">,</span> <span class="mf">43.252</span><span class="p">])</span>
<span class="n">String</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lineString</span><span class="p">)</span>
</pre></div>
</div>
<p>The Bounds expand method is now more robust.</p>
<p>An offset method was added to the Geometry class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Geometry</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Geometry</span><span class="o">.</span><span class="n">fromWKT</span><span class="p">(</span><span class="s2">&quot;LINESTRING (0 5, 5 5)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>IO</strong></p>
<p>Several optional parameters were added to the Feature GeoJSON Writer to control the number of decimals and how
to encode feature bounds, feature collection bounds, feature collection crs, feature crs, and whether to encode
null values.</p>
<p>The CSVReader can handle multiple geometry types.</p>
<p>The GeoScript.zip method now includes nested directories and GeoScript.unzip creates directories if necessary.</p>
<p><strong>Workspace</strong></p>
<p>Workspaces have much better connection string and maps which are useful for command line applications:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Workspace</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Workspace</span><span class="o">.</span><span class="n">getWorkspace</span><span class="p">(</span><span class="s2">&quot;dbtype=postgis database=postgres host=localhost port=5432 user=postgres passwd=postgres&quot;</span><span class="p">)</span>

<span class="n">Workspace</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Workspace</span><span class="o">.</span><span class="n">getWorkspace</span><span class="p">(</span><span class="s2">&quot;database=layers.gpkg dbtype=geopkg user=me passwd=s$cr$t&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Users of the OGR Workspace can now use the static setErrorHandler(quiet, logging, or default) method to control OGR’s logging:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OGR</span><span class="o">.</span><span class="n">setErrorHandler</span><span class="p">(</span><span class="s2">&quot;quiet&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>All workspaces now include a Workspace.remove(String name) method that can remove a Layer from the Workspace.</p>
<p>The Shapefile module inherited a Shapefile.dump(File,Layer) method from GeoTools:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Directory</span> <span class="n">workspace</span> <span class="o">=</span> <span class="n">Shapefile</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span>
</pre></div>
</div>
<p>Shapefile and Property layers can look up side car SLD or CSS files.</p>
<p>The Property Workspace got a getFile() method.</p>
<p>The WFS Workspace can optionally take user and password parameters.</p>
</div></blockquote>
</div>
<div class="section" id="id9">
<h2>1.6.0<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.6.0 release of GeoScript is built on Groovy 2.4.4, GeoTools 14.0, and the Java Topology Suite 1.13.</p>
<p>Significant new features include support for Geobuf, a OGR Workspace, and improvements to the Tile module.</p>
<p><strong>GeoHash</strong></p>
<p>GeoHash support was ported from the excellent node-geohash module.  It supports encoded and decoding Points and Bounds.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoHash</span> <span class="n">geohash</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoHash</span><span class="p">()</span>
<span class="n">geohash</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mf">112.5584</span><span class="p">,</span> <span class="mf">37.8324</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;ww8p1r4t8&quot;</span>

<span class="n">geohash</span><span class="o">.</span><span class="n">encodeLong</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mf">112.5584</span><span class="p">,</span> <span class="mf">37.8324</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">4064984913515641</span>

<span class="n">Bounds</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">geohash</span><span class="o">.</span><span class="n">decodeBounds</span><span class="p">(</span><span class="s2">&quot;ww8p1r4t8&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;(112.55836486816406,37.83236503601074,112.5584077835083,37.83240795135498)&quot;</span>
</pre></div>
</div>
<p><strong>Geobuf</strong></p>
<p>Geobuf is an emerging new format from MapBox.  GeoScript support for Geobuf includes a Workspace and Geometry, Feature, and Layer
readers and writers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="n">directory</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">Geobuf</span> <span class="n">geobuf</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Geobuf</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">an</span> <span class="ow">in</span> <span class="n">memory</span> <span class="n">Layer</span>
<span class="n">Memory</span> <span class="n">memory</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Memory</span><span class="p">()</span>
<span class="n">Layer</span> <span class="n">memoryLayer</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;locations&#39;</span><span class="p">,[</span><span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span> <span class="s2">&quot;Point&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;String&quot;</span><span class="p">)])</span>
<span class="n">memoryLayer</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;Seattle&quot;</span><span class="p">])</span>
<span class="n">memoryLayer</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;Portland&quot;</span><span class="p">])</span>
<span class="n">memoryLayer</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s2">&quot;Tacoma&quot;</span><span class="p">])</span>

<span class="o">//</span> <span class="n">And</span> <span class="n">add</span> <span class="n">it</span> <span class="n">to</span> <span class="n">Geobuf</span>
<span class="n">geobuf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">memoryLayer</span><span class="p">)</span>

<span class="n">GeobufWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeobufWriter</span><span class="p">()</span>
<span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Schema</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span><span class="s2">&quot;Point&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="s2">&quot;string&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="s2">&quot;float&quot;</span><span class="p">)])</span>
<span class="n">Feature</span> <span class="n">feature</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Feature</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="o">-</span><span class="mi">47</span><span class="p">),</span> <span class="s2">&quot;House&quot;</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">],</span> <span class="s2">&quot;house1&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
<span class="n">String</span> <span class="nb">hex</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;0a046e616d650a057072696365100218062a1f0a0c08001a0880e7ed69ffa6e92c6a070a05486f7573656a060a0431322e35&quot;</span>
</pre></div>
</div>
<p><strong>Workspace</strong></p>
<p>In addition to the new Geobuf Workspace, a OGR Workspace was also added.  This requires the GDAL/OGR native library
to be installed with Java/JNI support.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="n">shpFile</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span>
<span class="n">Layer</span> <span class="n">shpLayer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="n">shpFile</span><span class="p">)</span>

<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.sqlite&quot;</span><span class="p">)</span>
<span class="n">OGR</span> <span class="n">ogr</span> <span class="o">=</span> <span class="n">new</span> <span class="n">OGR</span><span class="p">(</span><span class="s2">&quot;SQLite&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">)</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">shpLayer</span><span class="o">.</span><span class="n">cursor</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;SPATIALITE=YES&quot;</span>
<span class="p">])</span>
</pre></div>
</div>
<p>WFS support upgraded to the new WFS-NG library.  Major thanks to Scottie and Neils who helped trouble shoot.</p>
<p><strong>Geometry</strong></p>
<p>The Geometry module some small improvements. A LineString.close() method creates a LinearRing.  The GeometryCollection.narrow() method
returns the most specific geometry type possible.  If all geometries are Points, narrow will return a MultiPoint.  Finally,
The Bounds.getCorners() returns a list of the 4 corners as Points.</p>
<p><strong>Layer</strong></p>
<p>The major improvement to the Layer module is the wrapping of the GeoTools gt-grid module in a Graticule class that makes creating
graticule based vector grids extremely easy.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">Graticule</span><span class="o">.</span><span class="n">createSquares</span><span class="p">(</span><span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="mf">110.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.0</span><span class="p">,</span> <span class="mf">160.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">File</span> <span class="nb">dir</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;squares&quot;</span><span class="p">)</span>
<span class="n">Workspace</span> <span class="n">workspace</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Directory</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">Graticule</span><span class="o">.</span><span class="n">createSquares</span><span class="p">(</span><span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="mf">110.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.0</span><span class="p">,</span> <span class="mf">160.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">workspace</span><span class="p">:</span> <span class="n">workspace</span><span class="p">,</span> <span class="n">layer</span><span class="p">:</span> <span class="s2">&quot;squares&quot;</span><span class="p">)</span>

<span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Schema</span><span class="p">(</span><span class="s2">&quot;hexagon&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">),</span>
    <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="s2">&quot;java.awt.Color&quot;</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">Bounds</span> <span class="n">b</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">Graticule</span><span class="o">.</span><span class="n">createHexagons</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;flat&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">schema</span><span class="p">,</span> <span class="n">setAttributes</span><span class="p">:</span> <span class="p">{</span> <span class="n">GridElement</span> <span class="n">e</span><span class="p">,</span> <span class="n">Map</span> <span class="n">attributes</span> <span class="o">-&gt;</span>
    <span class="nb">int</span> <span class="n">green</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">e</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">b</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>  <span class="k">as</span> <span class="nb">int</span>
    <span class="nb">int</span> <span class="n">blue</span>  <span class="o">=</span> <span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">e</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">b</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="k">as</span> <span class="nb">int</span>
    <span class="n">attributes</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p><strong>Raster</strong></p>
<p>The Raster module saw some minor improvements. A Format.has(String name) checks to see if a Raster by that name exists.
A few more Raster functions were added: log, exp, and absolute.  Finally, this version adds support for file names and
String urls when loading Rasters using the Format.getFormat() method.</p>
<p><strong>Tile</strong></p>
<p>The Tile module continued to improve with help from gpotts.</p>
<blockquote>
<div><ul>
<li><p>gpotts fixed a bug that assumed all Tile Grids started at 0</p></li>
<li><p>You can now delete tiles from a TileLayer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoPackage</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoPackage</span><span class="p">(</span><span class="n">newFile</span><span class="p">,</span> <span class="s2">&quot;states&quot;</span><span class="p">)</span>
<span class="n">Tile</span> <span class="n">tile</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>The TileGenerator has an option to only generate missing tiles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TileGenerator</span> <span class="n">generator</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TileGenerator</span><span class="p">()</span>
<span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">mbtiles</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">missingOnly</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>TileLayer can now be loaded from a connection parameter string (which is very useful for command line apps):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TileLayer</span> <span class="n">tileLayer</span> <span class="o">=</span> <span class="n">TileLayer</span><span class="o">.</span><span class="n">getTileLayer</span><span class="p">(</span><span class="s2">&quot;type=mbtiles file=states.mbtiles&quot;</span><span class="p">)</span>

<span class="n">TileLayer</span> <span class="n">tileLayer</span> <span class="o">=</span> <span class="n">TileLayer</span><span class="o">.</span><span class="n">getTileLayer</span><span class="p">(</span><span class="s2">&quot;type=tms file=/Users/geoscript/tiles format=jpeg&quot;</span><span class="p">)</span>

<span class="n">TileLayer</span> <span class="n">tileLayer</span> <span class="o">=</span> <span class="n">TileLayer</span><span class="o">.</span><span class="n">getTileLayer</span><span class="p">(</span><span class="s2">&quot;type=vectortiles file=vectortilesdir format=mvt pyramid=GlobalMercator&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>The TileLayer.getTileRenderer() static method returns a default TileRenderer for the given TileLayer.</p></li>
<li><p>PBF Vector Tiles now check for empty sub fields.</p></li>
<li><p>MVT support was rewritten to avoid creating huge empty byte buffers, support for dates was added, and the reader and write can round trip.</p></li>
<li><p>Pyramid readers and writers were added.  Formats include gdal tms mini driver xml fiels, xml, and json.</p></li>
<li><p>The Grid class now has min and max methods.</p></li>
<li><p>Pyramid support now supports geodetic, mercator, and global geodetic as well known names and Pyramid hash a static createGlobalGeodeticPyramid() method.</p></li>
</ul>
</div></blockquote>
<p><strong>Color</strong></p>
<p>The Color module includes support for custom palettes in addition to color brewer.</p>
<p><strong>Map</strong></p>
<p>The Map and rendering modules inherits awesome improvements from GeoTools including dash an an expression and single and multiple layer z ordering.</p>
</div></blockquote>
</div>
<div class="section" id="id10">
<h2>1.5.0<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.5.0 release of GeoScript is built on Groovy 2.3.10, GeoTools 13.0, and the Java Topology Suite 1.13.</p>
<p>In addition to bug fixes, there are significant improvements to the GeoPackage Workspace and TileLayer,
and the tile module in general including support for generating and consuming vector tiles.  GeoScript switched
to the Java based CSS module and includes composite and blending support.</p>
<p><strong>Tiles</strong></p>
<blockquote>
<div><p>Vector Tile support includes geojson, mvt, pbf:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="nb">dir</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states_vector_tiles_pbf&quot;</span><span class="p">)</span>
<span class="n">Pyramid</span> <span class="n">pyramid</span> <span class="o">=</span> <span class="n">Pyramid</span><span class="o">.</span><span class="n">createGlobalMercatorPyramid</span><span class="p">(</span><span class="n">origin</span><span class="p">:</span> <span class="n">Pyramid</span><span class="o">.</span><span class="n">Origin</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">)</span>
<span class="n">VectorTiles</span> <span class="n">vectorTiles</span> <span class="o">=</span> <span class="n">new</span> <span class="n">VectorTiles</span><span class="p">(</span>
    <span class="s2">&quot;states&quot;</span><span class="p">,</span>
    <span class="nb">dir</span><span class="p">,</span>
    <span class="n">pyramid</span><span class="p">,</span>
    <span class="s2">&quot;pbf&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;states&quot;</span><span class="p">:</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;wheat&quot;</span><span class="p">),</span>
        <span class="s2">&quot;states_centroids&quot;</span><span class="p">:</span> <span class="n">new</span> <span class="n">Shape</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span>
<span class="n">Layer</span> <span class="n">centroidLayer</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">&quot;states_centroids&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s2">&quot;geom&quot;</span><span class="p">:</span> <span class="s2">&quot;centroid(the_geom)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;STATE_NAME&quot;</span>
<span class="p">])</span>

<span class="n">PbfVectorTileRenderer</span> <span class="n">renderer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">PbfVectorTileRenderer</span><span class="p">([</span><span class="n">layer</span><span class="p">,</span> <span class="n">centroidLayer</span><span class="p">],</span> <span class="p">[</span>
        <span class="s2">&quot;states&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;STATE_NAME&quot;</span><span class="p">],</span>
        <span class="s2">&quot;states_centroids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">TileGenerator</span> <span class="n">generator</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TileGenerator</span><span class="p">(</span><span class="n">verbose</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
<span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">vectorTiles</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>The GeoPackage Tile origin is TOP LEFT not BOTTOM LEFT.</p>
<p>Pyramid.createGlobalMercatorPyramid can take named parameter origin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyramid</span> <span class="n">pyramid</span> <span class="o">=</span> <span class="n">Pyramid</span><span class="o">.</span><span class="n">createGlobalMercatorPyramid</span><span class="p">(</span><span class="n">origin</span><span class="p">:</span> <span class="n">Pyramid</span><span class="o">.</span><span class="n">Origin</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">)</span>
</pre></div>
</div>
<p>TileCursor validates z values</p>
<p>TileCursor guards against empty bounds</p>
<p>TileCursor getEmpty method</p>
<p>An empty TileCursor return a blank raster</p>
<p>TileGenerate can now generate tiles that intersect a bounds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TileGenerator</span> <span class="n">generator</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TileGenerator</span><span class="p">(</span><span class="n">verbose</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
<span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">45</span><span class="p">))</span>
</pre></div>
</div>
<p>Fixed bounds bug in Pyramid</p>
<p>Fixed Grid size exceeding precision</p>
</div></blockquote>
<p><strong>Geometry</strong></p>
<blockquote>
<div><p>Bounds intersection keeps projection</p>
<p>Bounds string can include Projection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Bounds</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">Bounds</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="s2">&quot;0,0,10,10,EPSG:4326&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>WktReader can read EWKT with SRID prefixes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WktReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">WktReader</span><span class="p">()</span>
<span class="n">Point</span> <span class="n">pt</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;SRID=4326;POINT (111 -47)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Added missing Geometry.getDimension() method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Geometry</span><span class="o">.</span><span class="n">fromWKT</span><span class="p">(</span><span class="s2">&quot;POINT (1 1)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dimension</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">0</span>
<span class="n">Geometry</span><span class="o">.</span><span class="n">fromWKT</span><span class="p">(</span><span class="s2">&quot;LINESTRING (1 1, 10 10)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dimension</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span>
<span class="n">Geometry</span><span class="o">.</span><span class="n">fromWKT</span><span class="p">(</span><span class="s2">&quot;POLYGON ((90 90, 90 110, 110 110, 110 90, 90 90))&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dimension</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Projection</strong></p>
<blockquote>
<div><p>Added Projection.getSrs() method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Projection</span> <span class="n">p</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;urn:ogc:def:crs:EPSG::4326&quot;</span><span class="p">)</span>
<span class="n">println</span> <span class="n">p</span><span class="o">.</span><span class="n">srs</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;urn:ogc:def:crs:EPSG::4326&quot;</span>
<span class="n">println</span> <span class="n">p</span><span class="o">.</span><span class="n">getSrs</span><span class="p">(</span><span class="n">true</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;4326&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Style</strong></p>
<blockquote>
<div><p>CSS reader uses Java version instead of Scala version</p>
<p>Document ColorMap’s opacity and label properties</p>
<p>Shape Symbolizer support anchor and displacement properties:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shape</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shape</span><span class="p">(</span><span class="n">color</span><span class="p">:</span>  <span class="s2">&quot;blue&quot;</span><span class="p">,</span>  <span class="n">size</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;square&quot;</span><span class="p">,</span> <span class="n">anchorPoint</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="n">displacement</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">])</span>
</pre></div>
</div>
<p>Composite and Blending support were added to the Style API:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">shp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span>
<span class="n">Function</span> <span class="n">func</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Function</span><span class="p">(</span><span class="s2">&quot;Recode(SUB_REGION,&#39;N Eng&#39;,&#39;#6495ED&#39;,&#39;Mid Atl&#39;,&#39;#B0C4DE&#39;,&#39;S Atl&#39;,&#39;#00FFFF&#39;,</span>
    <span class="s1">&#39;E N Cen&#39;</span><span class="p">,</span><span class="s1">&#39;#9ACD32&#39;</span><span class="p">,</span><span class="s1">&#39;E S Cen&#39;</span><span class="p">,</span><span class="s1">&#39;#00FA9A&#39;</span><span class="p">,</span><span class="s1">&#39;W N Cen&#39;</span><span class="p">,</span><span class="s1">&#39;#FFF8DC&#39;</span><span class="p">,</span><span class="s1">&#39;W S Cen&#39;</span><span class="p">,</span><span class="s1">&#39;#F5DEB3&#39;</span><span class="p">,</span><span class="s1">&#39;Mtn&#39;</span><span class="p">,</span><span class="s1">&#39;#F4A460&#39;</span><span class="p">,</span><span class="s1">&#39;Pacific&#39;</span><span class="p">,</span><span class="s1">&#39;#87CEEB&#39;</span><span class="p">)</span><span class="s2">&quot;)</span>
<span class="n">shp</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">composite</span><span class="p">(</span><span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="n">symbolizer</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="n">true</span><span class="p">))</span><span class="o">.</span><span class="n">zindex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">composite</span><span class="p">(</span><span class="s2">&quot;destination-in&quot;</span><span class="p">,</span> <span class="n">symbolizer</span><span class="p">:</span> <span class="n">false</span><span class="p">))</span><span class="o">.</span><span class="n">zindex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;#999999&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Label</span><span class="p">(</span><span class="s2">&quot;STATE_ABBR&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span><span class="o">.</span><span class="n">zindex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span>
    <span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">shp</span><span class="p">],</span>
    <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span>
<span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;style_composite.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/style_composite.png" src="_images/style_composite.png" />
</div></blockquote>
<p><strong>Workspace</strong></p>
<blockquote>
<div><p>GeoPackage Workspace Layers are now compatible with GDAL/OGR, QGIS, and ArcMap.</p>
<p>To make sure that Workspaces are closed you can use the new Workspace.withWorkspace(Workspace, Closure) idiom:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Workspace</span><span class="o">.</span><span class="n">withWorkspace</span><span class="p">(</span><span class="n">new</span> <span class="n">H2</span><span class="p">(</span><span class="n">folder</span><span class="o">.</span><span class="n">newFile</span><span class="p">(</span><span class="s2">&quot;roads.db&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">))</span> <span class="p">{</span> <span class="n">Workspace</span> <span class="n">w</span> <span class="o">-&gt;</span>
    <span class="o">//</span> <span class="n">Use</span> <span class="n">the</span> <span class="n">Workspace</span> <span class="n">here</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Layer</strong></p>
<blockquote>
<div><p>The Shapefile Layers gets zip and unzip methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shapefile</span> <span class="n">shp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="s2">&quot;states.shp&quot;</span><span class="p">))</span>

<span class="o">//</span> <span class="n">Zip</span> <span class="n">the</span> <span class="n">Shapefile</span><span class="s1">&#39;s files</span>
<span class="n">File</span> <span class="n">zipFile</span> <span class="o">=</span> <span class="n">shp</span><span class="o">.</span><span class="n">zip</span><span class="p">()</span>

<span class="o">//</span> <span class="n">Unzip</span>
<span class="n">Shapefile</span> <span class="n">shp2</span> <span class="o">=</span> <span class="n">Shapefile</span><span class="o">.</span><span class="n">unzip</span><span class="p">(</span><span class="n">zipFile</span><span class="p">)</span>
</pre></div>
</div>
<p>Remove new lines from content in CsvWriter</p>
<p>Fixed a bug with Groovy and Layer.reproject</p>
<p>The Schema class gets a getSpec() method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Schema</span><span class="p">(</span><span class="s2">&quot;widgets&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span><span class="s2">&quot;Point&quot;</span><span class="p">),</span>
    <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="s2">&quot;string&quot;</span><span class="p">),</span>
    <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">println</span> <span class="n">schema</span><span class="o">.</span><span class="n">spec</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;geom:Point,name:String,price:Float&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Raster</strong></p>
<blockquote>
<div><p>Format.getFormat() accepts inputs besides file</p>
<p>The Raster class has a new extractFootPrint() method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;raster.tif&quot;</span><span class="p">)</span>
<span class="n">GeoTIFF</span> <span class="n">geoTIFF</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">geoTIFF</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">extractFootPrint</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Rendering</strong></p>
<blockquote>
<div><p>ASCII Map Renderer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">))</span>
<span class="n">layer</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">],</span> <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">ASCII</span> <span class="n">renderer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ASCII</span><span class="p">(</span><span class="n">width</span><span class="p">:</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>..................................................
..................................................
..................................................
..................................................
..................................................
..................................................
..)))))$))))))))))))))))))........................
))))))))))))))))))))))))))))))....................
+)))))))))))))))))))))))))))))))-):............)).
.))))))))$))))))))))))))))))))))^.))..........-))+
:)))))))))))))))))))))))))))$))).)))......)):)$)..
))))))))))))))))))+****))))))))).))))...))))*))...
)))))))))))))))))))))))))))))))).)))..)))))))))...
)))))))))))))-))))))))))))))))))))$))))))))):.....
.))))))))))))+))))))))))))))))))))*))))+%)$+......
.))))))))))))+))))))))))))))))))))))%)))))).......
..)))))))))))+))))))))))))))))$)))))*))))*........
...))))))))))$))))))))))))))))))))))%)))):?.......
...:)))))))))$))))))))))))))))))))))))+)))........
......)))))))$)))))))))))))))))-))))))))..........
......-.*))))$))))))))))))$)))))))))))!...........
............:$..)))))))))))))))))))))*............
.................)))))))))))))!..:)))^............
..................-..)))))..........))............
.....................)))............%)............
......................)).............))...........
..................................................
..................................................
..................................................
..................................................
..................................................
..................................................
..................................................
</pre></div>
</div>
</div></blockquote>
<p><strong>Development</strong></p>
<blockquote>
<div><p>Started using <a class="reference external" href="https://travis-ci.org/geoscript/geoscript-groovy">Travis CI</a></p>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="id11">
<h2>1.4.0<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.4 release of GeoScript is built on Groovy 2.2, GeoTools 12, and the Java Topology Suite 1.13.</p>
<p>In addition to many bug fixes and performance improvements, the major new features include a tile module,
GeoPackage support, curved geometry types, and quick start docs for maven and gradle.</p>
<p><strong>Tile Module</strong></p>
<blockquote>
<div><p>The tile module provides simple ways to consume and create tiled maps.</p>
<p>Supported tiled formats include:</p>
<blockquote>
<div><ul class="simple">
<li><p>MBTiles</p></li>
<li><p>GeoPackage</p></li>
<li><p>UTFGrid</p></li>
<li><p>TMS</p></li>
<li><p>OSM</p></li>
</ul>
</div></blockquote>
<p>You can create tiles in MBTiles, GeoPackage, TMS, or OSM formats:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shapefile</span> <span class="n">shp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">))</span>
<span class="n">shp</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;wheat&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.mbtiles&quot;</span><span class="p">)</span>
<span class="n">MBTiles</span> <span class="n">mbtiles</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MBTiles</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="s2">&quot;A map of the united states&quot;</span><span class="p">)</span>

<span class="n">TileRenderer</span> <span class="n">renderer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ImageTileRenderer</span><span class="p">(</span><span class="n">mbtiles</span><span class="p">,</span> <span class="n">shp</span><span class="p">)</span>
<span class="n">TileGenerator</span> <span class="n">generator</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TileGenerator</span><span class="p">(</span><span class="n">verbose</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
<span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">mbtiles</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then use these tile sets to extract Rasters or as base maps when rendering:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OSM</span> <span class="n">osm</span> <span class="o">=</span> <span class="n">new</span> <span class="n">OSM</span><span class="p">(</span><span class="s2">&quot;Stamen Terrain&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s2">&quot;http://a.tile.stamen.com/terrain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://b.tile.stamen.com/terrain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://c.tile.stamen.com/terrain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://d.tile.stamen.com/terrain&quot;</span>
<span class="p">])</span>

<span class="n">Shapefile</span> <span class="n">shp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span>
<span class="p">[</span><span class="s2">&quot;North Dakota&quot;</span><span class="p">,</span> <span class="s2">&quot;Oregon&quot;</span><span class="p">,</span> <span class="s2">&quot;Washington&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="n">String</span> <span class="n">name</span> <span class="o">-&gt;</span>
    <span class="n">shp</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">(</span><span class="s2">&quot;STATE_NAME = &#39;$</span><span class="si">{name}</span><span class="s2">&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="n">Feature</span> <span class="n">f</span> <span class="o">-&gt;</span>
        <span class="n">Bounds</span> <span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">expandBy</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">proj</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
        <span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">osm</span><span class="o">.</span><span class="n">getRaster</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">),</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
        <span class="n">ImageIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raster</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="si">{name}</span><span class="s2">.png&quot;</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>GeoPackage</strong></p>
<blockquote>
<div><p>GeoPackage support includes a Workspace (geoscript.workspace.GeoPackage) for vector features:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Workspace</span> <span class="n">geopkg</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoPackage</span><span class="p">(</span><span class="n">folder</span><span class="o">.</span><span class="n">newFile</span><span class="p">(</span><span class="s2">&quot;geopkg.gpkg&quot;</span><span class="p">))</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">States</span> <span class="n">Shapefile</span>
    <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getClassLoader</span><span class="p">()</span><span class="o">.</span><span class="n">getResource</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toURI</span><span class="p">())</span>
    <span class="n">Shapefile</span> <span class="n">shp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="o">//</span> <span class="n">Add</span> <span class="n">states</span> <span class="n">shapefile</span> <span class="n">to</span> <span class="n">the</span> <span class="n">GeoPackage</span> <span class="n">database</span>
    <span class="n">Layer</span> <span class="n">l</span> <span class="o">=</span> <span class="n">geopkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">shp</span><span class="p">,</span> <span class="s1">&#39;states&#39;</span><span class="p">)</span>
    <span class="n">geopkg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;states&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eachFeature</span> <span class="p">{</span> <span class="n">Feature</span> <span class="n">f</span> <span class="o">-&gt;</span>
        <span class="n">println</span> <span class="s2">&quot;$</span><span class="si">{f[&#39;STATE_NAME&#39;]}</span><span class="s2"> at $</span><span class="si">{f.geom}</span><span class="s2">&quot;</span>
    <span class="p">}</span>

    <span class="o">//</span> <span class="n">Add</span> <span class="n">the</span> <span class="n">centroids</span> <span class="n">of</span> <span class="n">each</span> <span class="n">state</span> <span class="n">to</span> <span class="n">the</span> <span class="n">GeoPackage</span> <span class="n">database</span>
    <span class="n">Layer</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">geopkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">shp</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">&quot;state_centroids&quot;</span><span class="p">,</span> <span class="p">[</span>
            <span class="n">geom</span><span class="p">:</span> <span class="s2">&quot;centroid(the_geom)&quot;</span><span class="p">,</span>
            <span class="n">abbr</span><span class="p">:</span> <span class="s2">&quot;STATE_ABBR&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;STATE_NAME&quot;</span>
    <span class="p">]))</span>
    <span class="n">geopkg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;state_centroids&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eachFeature</span> <span class="p">{</span> <span class="n">Feature</span> <span class="n">f</span> <span class="o">-&gt;</span>
        <span class="n">println</span> <span class="s2">&quot;$</span><span class="si">{f[&#39;STATE_NAME&#39;]}</span><span class="s2"> at $</span><span class="si">{f.geom}</span><span class="s2">&quot;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="n">geopkg</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And a TileLayer (geoscript.layer.GeoPackage) for tiled layers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shapefile</span> <span class="n">shp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">))</span>
<span class="n">shp</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;wheat&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.mbtiles&quot;</span><span class="p">)</span>
<span class="n">GeoPackage</span> <span class="n">gpkg</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoPackage</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="n">Pyramid</span><span class="o">.</span><span class="n">createGlobalMercatorPyramid</span><span class="p">())</span>

<span class="n">TileRenderer</span> <span class="n">renderer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ImageTileRenderer</span><span class="p">(</span><span class="n">gpkg</span><span class="p">,</span> <span class="n">shp</span><span class="p">)</span>
<span class="n">TileGenerator</span> <span class="n">generator</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TileGenerator</span><span class="p">(</span><span class="n">verbose</span><span class="p">:</span> <span class="n">true</span><span class="p">)</span>
<span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">gpkg</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Curved Geometries</strong></p>
<blockquote>
<div><ul>
<li><p>CircularString:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CircularString</span> <span class="n">cs</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CircularString</span><span class="p">(</span>
    <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mf">6.12</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
    <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mf">7.07</span><span class="p">,</span> <span class="mf">7.07</span><span class="p">),</span>
    <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>CircularRing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CircularRing</span> <span class="n">cr</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CircularRing</span><span class="p">(</span>
    <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>CompoundCurve:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CompoundCurve</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CompoundCurve</span><span class="p">(</span>
    <span class="n">new</span> <span class="n">CircularString</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]),</span>
    <span class="n">new</span> <span class="n">LineString</span><span class="p">([</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>CompoundRing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CompoundRing</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CompoundRing</span><span class="p">(</span>
    <span class="n">new</span> <span class="n">CircularString</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]),</span>
    <span class="n">new</span> <span class="n">LineString</span><span class="p">([</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>Quick start docs</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Maven</strong> Create a simple app using Maven</p></li>
<li><p><strong>Maven Web App with JNDI</strong> Create a web app with Maven using JNDI</p></li>
<li><p><strong>Gradle</strong> Create a simple app using Gradle</p></li>
</ul>
</div></blockquote>
<p><strong>API Updates</strong></p>
<blockquote>
<div><ul>
<li><p>Workspace.has(String name):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Workspace workspace = new Memory()
if (!workspace.has(&quot;points&quot;)) {
    workspace.create(&quot;points&quot;, [[&quot;the_geom&quot;, &quot;Point&quot;, &quot;EPSG:4326&quot;]])
}
</pre></div>
</div>
</li>
<li><p>Raster.selectBands(List&lt;Integer&gt; bands, int visibleBand = -1):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;alki.tif&quot;</span><span class="p">)</span>
<span class="n">GeoTIFF</span> <span class="n">geoTIFF</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">geoTIFF</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">Raster</span> <span class="n">rbRaster</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">selectBands</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Raster.transform(Map options = [:]):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;raster.tif&quot;</span><span class="p">)</span>
<span class="n">GeoTIFF</span> <span class="n">geoTIFF</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">geoTIFF</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="o">//</span> <span class="n">Scale</span>
<span class="n">Raster</span> <span class="n">scaledRaster</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">scalex</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">scaley</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Shear</span>
<span class="n">Raster</span> <span class="n">shearRaster</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">shearx</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">sheary</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Translate</span>
<span class="n">Raster</span> <span class="n">translatedRaster</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">translatex</span><span class="p">:</span> <span class="mf">10.1</span><span class="p">,</span> <span class="n">translatey</span><span class="p">:</span> <span class="mf">12.6</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Combo</span>
<span class="n">Raster</span> <span class="n">transformedRaster</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="n">scalex</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">scaley</span><span class="p">:</span> <span class="mf">2.1</span><span class="p">,</span>
        <span class="n">shearx</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">sheary</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="n">translatex</span><span class="p">:</span> <span class="mf">10.1</span><span class="p">,</span> <span class="n">translatey</span><span class="p">:</span> <span class="mf">12.6</span><span class="p">,</span>
        <span class="n">nodata</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">255</span><span class="p">],</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="s2">&quot;NEAREST&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Projection.getEpsg():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Projection</span> <span class="n">p</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;EPSG:2927&quot;</span><span class="p">)</span>
<span class="nb">int</span> <span class="n">epsg</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">epsg</span>
</pre></div>
</div>
</li>
<li><p>Added advanced projection handling and continous map wrapping to the Map Renderer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.</span><span class="o">*</span>
<span class="kn">import</span> <span class="nn">geoscript.render.</span><span class="o">*</span>
<span class="kn">import</span> <span class="nn">geoscript.style.</span><span class="o">*</span>
<span class="kn">import</span> <span class="nn">geoscript.geom.</span><span class="o">*</span>

<span class="n">Shapefile</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;110m_admin_0_countries.shp&quot;</span><span class="p">))</span>
<span class="n">layer</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;#eee&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#666&quot;</span><span class="p">)</span>
<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;world.png&quot;</span><span class="p">)</span>

<span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span>
    <span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">],</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">proj</span><span class="p">:</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
    <span class="n">bounds</span><span class="p">:</span> <span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="nb">map</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<img alt="_images/world.png" src="_images/world.png" />
<ul>
<li><p>Base64 Renderer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">))</span>
<span class="n">layer</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">],</span> <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">Base64</span> <span class="n">base64</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Base64</span><span class="p">()</span>
<span class="n">String</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Moved static Writer variables inside methods</p></li>
<li><p>Fixed performance problem with writing Layers to GeoRSS feeds due Proj.getId() being realllllly slow</p></li>
<li><p>Added ImageAssert tests</p></li>
<li><p>Workspace.getParametersFromString can now handle spatialite database files</p></li>
<li><p>Removed deprecated raster methods</p></li>
<li><p>Removed deprecated addSqlView methods from Database Workspace</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="id12">
<h2>1.3.1<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.3.1 release of GeoScript is built on Groovy 2.1.9, GeoTools 11.2, and the Java Topology Suite 1.13.  It contains a few minor bug fixes and performance improvements.</p>
<ul class="simple">
<li><p>Fixed a bug with Layer.first() call if there are no features</p></li>
<li><p>Added Projection.getEpsg() method</p></li>
<li><p>Fixed bug with JPEG renderer</p></li>
<li><p>Added Image.getImageType() method</p></li>
<li><p>Improved performance of the Layer GeoRSS writer</p></li>
<li><p>Added Base64 renderer</p></li>
<li><p>Moved static io reader/writers to instance variables</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id13">
<h2>1.3<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.3 release of GeoScript is built on Groovy 2.1.9, GeoTools 11.0, and the Java Topology Suite 1.13.</p>
<p><strong>Layer Geoprocessing and Layer Algebra</strong></p>
<blockquote>
<div><ul>
<li><p><strong>Layer Geoprocessing</strong></p>
<blockquote>
<div><ul>
<li><p>Split by Field</p>
<p>Split a Layer into multiple Layers using the value of a Field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Memory</span> <span class="n">workspace</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Memory</span><span class="p">()</span>
<span class="n">layer</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;col&quot;</span><span class="p">),</span> <span class="n">workspace</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Split by Layer</p>
<p>Split a Layer into multiple Layers based on the Features from the split Layer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Memory</span> <span class="n">workspace</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Memory</span><span class="p">()</span>
<span class="n">layer</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">splitLayer</span><span class="p">,</span><span class="n">splitLayer</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;row_col&quot;</span><span class="p">),</span><span class="n">workspace</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Buffer</p>
<p>Buffer all of the Features in the Layer.  The buffer distance can be a geoscript.filter.Expression or a double.
This allows variable distance buffers that depend on the value of a Field, a Function, or an Expression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">layer</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">new</span> <span class="n">geoscript</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="s2">&quot;col&quot;</span><span class="p">))</span>

<span class="n">layer</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">geoscript</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Expression</span><span class="o">.</span><span class="n">fromCQL</span><span class="p">(</span><span class="s2">&quot;col * 2&quot;</span><span class="p">))</span>

<span class="n">layer</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">new</span> <span class="n">geoscript</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s2">&quot;calc_buffer(row,col)&quot;</span><span class="p">,</span> <span class="p">{</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">-&gt;</span> <span class="n">row</span> <span class="o">+</span> <span class="n">col</span><span class="p">}))</span>
</pre></div>
</div>
</li>
<li><p>Merge</p>
<p>Merge a Layer with another Layer to create an output Layer.</p>
</li>
<li><p>Dissolve</p>
<p>Dissolve the Features of a Layer by a Field or dissolve intersecting Features of a Layer.</p>
</li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Layer Algebra</strong></p>
<p>The layer algebra methods were inspired by similar work done by the GDAL developers. The following
examples use the GDAL dataset.</p>
<blockquote>
<div><img alt="_images/la_layers.png" src="_images/la_layers.png" />
<ul>
<li><p>clip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layerA</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">layerB</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/la_clip_a_b.png" src="_images/la_clip_a_b.png" />
</li>
<li><p>union:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layerA</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">layerB</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/la_union.png" src="_images/la_union.png" />
</li>
<li><p>intersection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layerA</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">layerB</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/la_intersection.png" src="_images/la_intersection.png" />
</li>
<li><p>erase:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layerA</span><span class="o">.</span><span class="n">erase</span><span class="p">(</span><span class="n">layerB</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/la_erase_a_b.png" src="_images/la_erase_a_b.png" />
</li>
<li><p>identify:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layerA</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">layerB</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/la_identity_a_b.png" src="_images/la_identity_a_b.png" />
</li>
<li><p>update:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layerA</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">layerB</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/la_update_a_b.png" src="_images/la_update_a_b.png" />
</li>
<li><p>symDifference:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layerA</span><span class="o">.</span><span class="n">symDifference</span><span class="p">(</span><span class="n">layerB</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/la_symdifference.png" src="_images/la_symdifference.png" />
</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p><strong>Add batches of Features to a Layer</strong></p>
<blockquote>
<div><ul>
<li><p>The geoscript.layer.Writer class adds batches of Features to a Layer with a Transaction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Writer</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Writer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="n">Feature</span> <span class="n">f</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">newFeature</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="p">}</span>

<span class="n">Writer</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">batch</span><span class="p">)</span> <span class="p">{</span> <span class="n">writer</span> <span class="o">-&gt;</span>
    <span class="n">pts</span><span class="o">.</span><span class="n">eachWithIndex</span><span class="p">{</span><span class="n">Point</span> <span class="n">pt</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span> <span class="o">-&gt;</span>
        <span class="n">Feature</span> <span class="n">f</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">newFeature</span>
        <span class="n">f</span><span class="o">.</span><span class="n">geom</span> <span class="o">=</span> <span class="n">pt</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>GeoScript Layers have a getWriter() and withWriter() methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Writer</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">getWriter</span><span class="p">(</span><span class="n">autoCommit</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="mi">75</span><span class="p">)</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="n">pts</span><span class="o">.</span><span class="n">eachWithIndex</span><span class="p">{</span><span class="n">Point</span> <span class="n">pt</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span> <span class="o">-&gt;</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">feature</span><span class="p">([</span><span class="n">the_geom</span><span class="p">:</span> <span class="n">pt</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="n">i</span><span class="p">],</span> <span class="s2">&quot;point$</span><span class="si">{i}</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="p">}</span>

<span class="n">layer</span><span class="o">.</span><span class="n">withWriter</span><span class="p">(</span><span class="n">batch</span><span class="p">:</span> <span class="mi">45</span><span class="p">)</span> <span class="p">{</span><span class="n">Writer</span> <span class="n">writer</span> <span class="o">-&gt;</span>
    <span class="n">pts</span><span class="o">.</span><span class="n">eachWithIndex</span><span class="p">{</span><span class="n">Point</span> <span class="n">pt</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span> <span class="o">-&gt;</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">feature</span><span class="p">([</span><span class="n">the_geom</span><span class="p">:</span> <span class="n">pt</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="n">i</span><span class="p">],</span> <span class="s2">&quot;point$</span><span class="si">{i}</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>Database Workspace</strong></p>
<blockquote>
<div><ul>
<li><p>Improve SQL view layers by introducing <strong>createView</strong> and deprecating <strong>addSqlQuery</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">createView</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">,</span><span class="s2">&quot;SELECT * FROM </span><span class="se">\&quot;</span><span class="s2">states</span><span class="se">\&quot;</span><span class="s2"> WHERE </span><span class="se">\&quot;</span><span class="s2">STATE_ABBR</span><span class="se">\&quot;</span><span class="s2"> = &#39;</span><span class="si">%a</span><span class="s2">bbr%&#39;&quot;</span><span class="p">,</span>
    <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;the_geom&quot;</span><span class="p">,</span><span class="s2">&quot;Polygon&quot;</span><span class="p">,</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
    <span class="n">params</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;TX&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</li>
<li><p>Add groovy.sql.Sql access for all Database based Workspace with the <strong>getSql()</strong> method.
This allows you to do arbitray SQL queries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">H2</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">new</span> <span class="n">H2</span><span class="p">(</span><span class="n">folder</span><span class="o">.</span><span class="n">newFile</span><span class="p">(</span><span class="s2">&quot;h2.db&quot;</span><span class="p">))</span>
<span class="n">Layer</span> <span class="n">l</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;widgets&#39;</span><span class="p">,[</span><span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span> <span class="s2">&quot;Point&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;String&quot;</span><span class="p">)])</span>
<span class="n">l</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;one&quot;</span><span class="p">])</span>
<span class="n">l</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;two&quot;</span><span class="p">])</span>
<span class="n">l</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s2">&quot;three&quot;</span><span class="p">])</span>

<span class="o">//</span> <span class="n">Get</span> <span class="n">groovy</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">Sql</span>
<span class="k">def</span> <span class="nf">sql</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">sql</span>

<span class="o">//</span> <span class="n">Count</span> <span class="n">rows</span>
<span class="n">assertEquals</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">firstRow</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) as count FROM </span><span class="se">\&quot;</span><span class="s2">widgets</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">int</span>

<span class="o">//</span> <span class="n">Query</span>
<span class="n">List</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sql</span><span class="o">.</span><span class="n">eachRow</span> <span class="s2">&quot;SELECT </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2"> FROM </span><span class="se">\&quot;</span><span class="s2">widgets</span><span class="se">\&quot;</span><span class="s2"> ORDER BY </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2"> DESC&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">names</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
<span class="p">}</span>
<span class="n">println</span> <span class="n">names</span>

<span class="o">//</span> <span class="n">Insert</span>
<span class="n">sql</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO </span><span class="se">\&quot;</span><span class="s2">widgets</span><span class="se">\&quot;</span><span class="s2"> (</span><span class="se">\&quot;</span><span class="s2">geom</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">) VALUES (ST_GeomFromText(&#39;POINT (6 6)&#39;,4326), &#39;four&#39;)&quot;</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Query</span>
<span class="n">sql</span><span class="o">.</span><span class="n">eachRow</span> <span class="s2">&quot;SELECT ST_Buffer(</span><span class="se">\&quot;</span><span class="s2">geom</span><span class="se">\&quot;</span><span class="s2">, 10) as buffer, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2"> FROM </span><span class="se">\&quot;</span><span class="s2">widgets</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">{</span><span class="n">row</span> <span class="o">-&gt;</span>
    <span class="n">Geometry</span> <span class="n">poly</span> <span class="o">=</span> <span class="n">Geometry</span><span class="o">.</span><span class="n">fromWKB</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">buffer</span> <span class="k">as</span> <span class="n">byte</span><span class="p">[])</span>
    <span class="n">assertNotNull</span> <span class="n">poly</span>
    <span class="n">assertTrue</span> <span class="n">poly</span> <span class="n">instanceof</span> <span class="n">Polygon</span>
    <span class="n">assertNotNull</span> <span class="n">row</span><span class="o">.</span><span class="n">name</span>
<span class="p">}</span>

<span class="n">h2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>The H2 Workspace can connect to H2 databases using server mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">H2</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">new</span> <span class="n">H2</span><span class="p">(</span><span class="s2">&quot;database&quot;</span><span class="p">,</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="s2">&quot;5432&quot;</span><span class="p">,</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span> <span class="s2">&quot;sa&quot;</span><span class="p">,</span> <span class="s2">&quot;supersecret&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>JNDI support for PostGIS, MySQL, H2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PostGIS</span> <span class="n">postgis</span> <span class="o">=</span> <span class="n">new</span> <span class="n">PostGIS</span><span class="p">(</span><span class="s2">&quot;java:comp/env/jdbc/geoscript&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="s2">&quot;public&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>PostGIS can create or drop database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PostGIS</span> <span class="n">postgis</span> <span class="o">=</span> <span class="n">new</span> <span class="n">PostGIS</span><span class="p">(</span><span class="s2">&quot;database&quot;</span><span class="p">,</span> <span class="n">createDatabase</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="n">createDatabaseParams</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Database Workspaces can create, delete, list indexes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Add</span> <span class="n">two</span> <span class="n">indexes</span>
<span class="n">h2</span><span class="o">.</span><span class="n">createIndex</span><span class="p">(</span><span class="s2">&quot;widgets&quot;</span><span class="p">,</span><span class="s2">&quot;geom_idx&quot;</span><span class="p">,</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span><span class="n">false</span><span class="p">)</span>
<span class="n">h2</span><span class="o">.</span><span class="n">createIndex</span><span class="p">(</span><span class="s2">&quot;widgets&quot;</span><span class="p">,</span><span class="s2">&quot;name_idx&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="n">true</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">indexes</span>
<span class="n">List</span> <span class="n">indexes</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">getIndexes</span><span class="p">(</span><span class="s2">&quot;widgets&quot;</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Delete</span> <span class="n">the</span> <span class="n">geom</span> <span class="n">index</span>
<span class="n">h2</span><span class="o">.</span><span class="n">deleteIndex</span><span class="p">(</span><span class="s2">&quot;widgets&quot;</span><span class="p">,</span><span class="s2">&quot;geom_idx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Database Workspace can remove layers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h2</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;points&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>Raster</strong></p>
<blockquote>
<div><ul>
<li><p>NetCDF Raster support:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NetCDF</span> <span class="n">netcdf</span> <span class="o">=</span> <span class="n">new</span> <span class="n">NetCDF</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">netcdf</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">each</span><span class="p">{</span> <span class="n">String</span> <span class="n">name</span> <span class="o">-&gt;</span>
    <span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">netcdf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">println</span> <span class="n">raster</span><span class="o">.</span><span class="n">bounds</span>
    <span class="n">raster</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>API Change to Raster/Format API</p>
<p>In order to support NetCDF Rasters, the Raster Format API was changed.  Contructors with a File or other way to connect to Rasters,
write methods that contain the destination, or read methods that contain the source have all been deprecated and will be removed in
the next release.  Instead, use contructors that contain a source or destination File, and read and write methods that take an optional
Raster name (in order to support Formats that can contain more than one Raster such as NetCDF).</p>
<p>Instead of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoTIFF</span> <span class="n">geotiff</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">()</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">geotiff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;world.tiff&quot;</span><span class="p">))</span>
<span class="n">geotiff</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raster</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">)),</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;cropped_world.tiff&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Please use the new API:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoTIFF</span> <span class="n">geotiff</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;world.tiff&quot;</span><span class="p">))</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">geotiff</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;cropped_world.tiff&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raster</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">)))</span>
</pre></div>
</div>
</li>
<li><p>Raster.crop(Geometry):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoTIFF</span> <span class="n">geoTIFF</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;alki.tiff&quot;</span><span class="p">))</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">geoTIFF</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">Geometry</span> <span class="n">geometry</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mf">1166761.4391797914</span><span class="p">,</span> <span class="mf">823593.195575958</span><span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
<span class="n">Raster</span> <span class="n">cropped</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>IO Readers/Writers</strong></p>
<blockquote>
<div><ul>
<li><p>GPX Geometry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GpxReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GpxReader</span><span class="p">()</span>
<span class="n">Geometry</span> <span class="n">g</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;&lt;wpt lat=&#39;2.0&#39; lon=&#39;1.0&#39;/&gt;&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;POINT (1 2)&quot;</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">wkt</span>

<span class="n">GpxWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GpxWriter</span><span class="p">()</span>
<span class="k">assert</span> <span class="s2">&quot;&lt;wpt lat=&#39;2.0&#39; lon=&#39;1.0&#39;/&gt;&quot;</span> <span class="o">==</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>GPX Feature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">gpx</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;wpt lat=&quot;0.0&quot; lon=&quot;0.0&quot;&gt;</span>
<span class="s2">&lt;name&gt;1&lt;/name&gt;</span>
<span class="s2">&lt;desc&gt;This is feature # 1&lt;/desc&gt;</span>
<span class="s2">&lt;type&gt;Trail&lt;/type&gt;</span>
<span class="s2">&lt;ele&gt;45.2&lt;/ele&gt;</span>
<span class="s2">&lt;time&gt;1/20/14 1:47 PM&lt;/time&gt;</span>
<span class="s2">&lt;/wpt&gt;&quot;&quot;&quot;</span>
<span class="n">GpxReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GpxReader</span><span class="p">()</span>
<span class="n">Feature</span> <span class="n">feature</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">gpx</span><span class="p">)</span>

<span class="n">GpxWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GpxWriter</span><span class="p">(</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">new</span> <span class="n">Property</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">),</span>
        <span class="n">time</span><span class="p">:</span> <span class="s2">&quot;1/20/14 1:47 PM&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="p">{</span> <span class="n">Feature</span> <span class="n">f</span> <span class="o">-&gt;</span> <span class="s2">&quot;This is feature #$</span><span class="si">{f[&#39;id&#39;]}</span><span class="s2">&quot;</span> <span class="p">},</span>
        <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;Trail&quot;</span>
<span class="p">)</span>
<span class="n">String</span> <span class="n">gpx</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">gpx</span> <span class="o">==</span> <span class="s2">&quot;&lt;wpt lat=&#39;0.0&#39; lon=&#39;0.0&#39; xmlns=&#39;http://www.topografix.com/GPX/1/1&#39;&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;name&gt;1&lt;/name&gt;&lt;desc&gt;This is feature #1&lt;/desc&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;type&gt;Trail&lt;/type&gt;&lt;time&gt;1/20/14 1:47 PM&lt;/time&gt;&lt;/wpt&gt;&quot;</span>
</pre></div>
</div>
<p>GPX Layer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">gpx</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="s2">    &lt;gpx xmlns=&quot;http://www.topografix.com/GPX/1/1&quot; version=&quot;1.1&quot; creator=&quot;geoscript&quot;&gt;</span>
<span class="s2">    &lt;wpt lat=&quot;0.0&quot; lon=&quot;0.0&quot;&gt;</span>
<span class="s2">    &lt;name&gt;1&lt;/name&gt;</span>
<span class="s2">    &lt;desc&gt;This is feature # 1&lt;/desc&gt;</span>
<span class="s2">    &lt;type&gt;Trail&lt;/type&gt;</span>
<span class="s2">    &lt;ele&gt;45.2&lt;/ele&gt;</span>
<span class="s2">    &lt;time&gt;1/20/14 1:47 PM&lt;/time&gt;</span>
<span class="s2">    &lt;/wpt&gt;</span>
<span class="s2">    &lt;/gpx&gt;&quot;&quot;&quot;</span>
<span class="n">GpxReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GpxReader</span><span class="p">(</span><span class="nb">type</span><span class="p">:</span> <span class="n">GpxReader</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">WayPoints</span><span class="p">)</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">gpx</span><span class="p">)</span>

<span class="n">GpxWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GpxWriter</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">new</span> <span class="n">Property</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">),</span>
    <span class="n">time</span><span class="p">:</span> <span class="s2">&quot;1/20/14 1:47 PM&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="p">{</span><span class="n">Feature</span> <span class="n">f</span> <span class="o">-&gt;</span> <span class="s2">&quot;This is feature # $</span><span class="si">{f[&#39;id&#39;]}</span><span class="s2">&quot;</span><span class="p">},</span>
    <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;Trail&quot;</span>
<span class="p">)</span>
<span class="n">String</span> <span class="n">gpx</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Kml IO rewritten to use Groovy’s markup builder</p>
<p>Geometry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KmlWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">KmlWriter</span><span class="p">()</span>
<span class="n">Point</span> <span class="n">p</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="o">-</span><span class="mi">47</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;&lt;Point&gt;&lt;coordinates&gt;111.0,-47.0&lt;/coordinates&gt;&lt;/Point&gt;&quot;</span> <span class="o">==</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="n">KmlReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">KmlReader</span><span class="p">()</span>
<span class="n">Point</span> <span class="n">pt</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;&lt;Point&gt;&lt;coordinates&gt;111.0,-47.0&lt;/coordinates&gt;&lt;/Point&gt;&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;POINT (111 -47)&quot;</span> <span class="o">==</span> <span class="n">pt</span><span class="o">.</span><span class="n">wkt</span>
</pre></div>
</div>
<p>Feature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">kml</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;kml:Placemark xmlns:kml=&quot;http://earth.google.com/kml/2.1&quot; id=&quot;house1&quot;&gt;</span>
<span class="s2">&lt;kml:name&gt;House&lt;/kml:name&gt;</span>
<span class="s2">&lt;kml:Point&gt;</span>
<span class="s2">&lt;kml:coordinates&gt;111.0,-47.0&lt;/kml:coordinates&gt;</span>
<span class="s2">&lt;/kml:Point&gt;</span>
<span class="s2">&lt;/kml:Placemark&gt;&quot;&quot;&quot;</span>
<span class="n">KmlReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">KmlReader</span><span class="p">()</span>
<span class="n">Feature</span> <span class="n">f</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">kml</span><span class="p">)</span>

<span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Schema</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span><span class="s2">&quot;Point&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="s2">&quot;string&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="s2">&quot;float&quot;</span><span class="p">)])</span>
<span class="n">Feature</span> <span class="n">feature</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Feature</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="o">-</span><span class="mi">47</span><span class="p">),</span> <span class="s2">&quot;House&quot;</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">],</span> <span class="s2">&quot;house1&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
<span class="n">KmlWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">KmlWriter</span><span class="p">()</span>
<span class="k">assert</span> <span class="s2">&quot;&quot;&quot;&lt;kml:Placemark xmlns:kml=&quot;http://earth.google.com/kml/2.1&quot; id=&quot;house1&quot;&gt;</span>
<span class="s2">&lt;kml:name&gt;House&lt;/kml:name&gt;</span>
<span class="s2">&lt;kml:Point&gt;</span>
<span class="s2">&lt;kml:coordinates&gt;111.0,-47.0&lt;/kml:coordinates&gt;</span>
<span class="s2">&lt;/kml:Point&gt;</span>
<span class="s2">&lt;/kml:Placemark&gt;&quot;&quot;&quot;</span> <span class="o">==</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
</pre></div>
</div>
<p>Layer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">kml</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;kml:kml xmlns:kml=&quot;http://earth.google.com/kml/2.1&quot;&gt;</span>
<span class="s2">    &lt;kml:Document id=&quot;featureCollection&quot;&gt;</span>
<span class="s2">        &lt;kml:Placemark id=&quot;fid--259df7e1_131b6de0b8f_-8000&quot;&gt;</span>
<span class="s2">            &lt;kml:name&gt;House&lt;/kml:name&gt;</span>
<span class="s2">            &lt;kml:Point&gt;</span>
<span class="s2">                &lt;kml:coordinates&gt;111.0,-47.0&lt;/kml:coordinates&gt;</span>
<span class="s2">            &lt;/kml:Point&gt;</span>
<span class="s2">        &lt;/kml:Placemark&gt;</span>
<span class="s2">        &lt;kml:Placemark id=&quot;fid--259df7e1_131b6de0b8f_-7fff&quot;&gt;</span>
<span class="s2">            &lt;kml:name&gt;School&lt;/kml:name&gt;</span>
<span class="s2">            &lt;kml:Point&gt;</span>
<span class="s2">                &lt;kml:coordinates&gt;121.0,-45.0&lt;/kml:coordinates&gt;</span>
<span class="s2">            &lt;/kml:Point&gt;</span>
<span class="s2">        &lt;/kml:Placemark&gt;</span>
<span class="s2">    &lt;/kml:Document&gt;</span>
<span class="s2">&lt;/kml:kml&gt;&quot;&quot;&quot;</span>
<span class="n">KmlReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">KmlReader</span><span class="p">()</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">kml</span><span class="p">)</span>

<span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Schema</span><span class="p">(</span><span class="s2">&quot;houses&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span> <span class="s2">&quot;Point&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Field</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">)])</span>
<span class="n">Memory</span> <span class="n">memory</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Memory</span><span class="p">()</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Feature</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="o">-</span><span class="mi">47</span><span class="p">),</span> <span class="s2">&quot;House&quot;</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">],</span> <span class="s2">&quot;house1&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">))</span>
<span class="n">layer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">Feature</span><span class="p">([</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">),</span> <span class="s2">&quot;School&quot;</span><span class="p">,</span> <span class="mf">22.7</span><span class="p">],</span> <span class="s2">&quot;house2&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">))</span>
<span class="n">KmlWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">KmlWriter</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>GeoRSS IO using Groovy’s markup builder and xml parser</p>
<p>Geometry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoRSSReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoRSSReader</span><span class="p">()</span>
<span class="n">Point</span> <span class="n">p</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;&lt;georss:point&gt;45.256 -71.92&lt;/georss:point&gt;&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;POINT (-71.92, 45.256)&quot;</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">wkt</span>

<span class="n">GeoRSSWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoRSSWriter</span><span class="p">()</span>
<span class="n">Point</span> <span class="n">p</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">71.92</span><span class="p">,</span> <span class="mf">45.256</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;&lt;georss:point&gt;45.256 -71.92&lt;/georss:point&gt;&quot;</span> <span class="o">==</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>Feature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoRSSReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoRSSReader</span><span class="p">()</span>
<span class="n">String</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&lt;entry xmlns:georss=&#39;http://www.georss.org/georss&#39; xmlns=&#39;http://www.w3.org/2005/Atom&#39;&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;title&gt;house1&lt;/title&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;summary&gt;[geom:POINT (111 -47), name:House, price:12.5]&lt;/summary&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;updated&gt;12/7/2013&lt;/updated&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;georss:point&gt;-47.0 111.0&lt;/georss:point&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;/entry&gt;&quot;</span>
<span class="n">Feature</span> <span class="n">feature</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="n">GeoRSSWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoRSSWriter</span><span class="p">(</span><span class="n">feedType</span><span class="p">:</span> <span class="s2">&quot;atom&quot;</span><span class="p">,</span> <span class="n">geometryType</span><span class="p">:</span> <span class="s2">&quot;gml&quot;</span><span class="p">,</span> <span class="n">itemDate</span><span class="p">:</span> <span class="s2">&quot;12/7/2013&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;&lt;entry xmlns:georss=&#39;http://www.georss.org/georss&#39; xmlns=&#39;http://www.w3.org/2005/Atom&#39; &quot;</span> <span class="o">+</span>
    <span class="s2">&quot;xmlns:gml=&#39;http://www.opengis.net/gml&#39;&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;title&gt;house1&lt;/title&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;summary&gt;[geom:POINT (111 -47), name:House, price:12.5]&lt;/summary&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;updated&gt;12/7/2013&lt;/updated&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;georss:where&gt;&lt;gml:Point&gt;&lt;gml:pos&gt;-47.0 111.0&lt;/gml:pos&gt;&lt;/gml:Point&gt;&lt;/georss:where&gt;&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;&lt;/entry&gt;&quot;</span> <span class="o">==</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
</pre></div>
</div>
<p>Layer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GeoRSSReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoRSSReader</span><span class="p">()</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="s2"> &lt;feed xmlns=&quot;http://www.w3.org/2005/Atom&quot;</span>
<span class="s2">       xmlns:georss=&quot;http://www.georss.org/georss&quot;&gt;</span>
<span class="s2">   &lt;title&gt;Earthquakes&lt;/title&gt;</span>
<span class="s2">   &lt;subtitle&gt;International earthquake observation labs&lt;/subtitle&gt;</span>
<span class="s2">   &lt;link href=&quot;http://example.org/&quot;/&gt;</span>
<span class="s2">   &lt;updated&gt;2005-12-13T18:30:02Z&lt;/updated&gt;</span>
<span class="s2">   &lt;author&gt;</span>
<span class="s2">      &lt;name&gt;Dr. Thaddeus Remor&lt;/name&gt;</span>
<span class="s2">      &lt;email&gt;tremor@quakelab.edu&lt;/email&gt;</span>
<span class="s2">   &lt;/author&gt;</span>
<span class="s2">   &lt;id&gt;urn:uuid:60a76c80-d399-11d9-b93C-0003939e0af6&lt;/id&gt;</span>
<span class="s2">   &lt;entry&gt;</span>
<span class="s2">      &lt;title&gt;M 3.2, Mona Passage&lt;/title&gt;</span>
<span class="s2">      &lt;link href=&quot;http://example.org/2005/09/09/atom01&quot;/&gt;</span>
<span class="s2">      &lt;id&gt;urn:uuid:1225c695-cfb8-4ebb-aaaa-80da344efa6a&lt;/id&gt;</span>
<span class="s2">      &lt;updated&gt;2005-08-17T07:02:32Z&lt;/updated&gt;</span>
<span class="s2">      &lt;summary&gt;We just had a big one.&lt;/summary&gt;</span>
<span class="s2">      &lt;georss:box&gt;42.943 -71.032 43.039 -69.856&lt;/georss:box&gt;</span>
<span class="s2">   &lt;/entry&gt;</span>
<span class="s2"> &lt;/feed&gt;&quot;&quot;&quot;</span><span class="p">)</span>

 <span class="n">GeoRSSWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoRSSWriter</span><span class="p">(</span>
    <span class="n">feedType</span><span class="p">:</span> <span class="s2">&quot;atom&quot;</span><span class="p">,</span>
    <span class="n">geometryType</span><span class="p">:</span> <span class="s2">&quot;simple&quot;</span><span class="p">,</span>
    <span class="n">itemDate</span><span class="p">:</span> <span class="s2">&quot;1/22/1975&quot;</span><span class="p">,</span>
    <span class="n">itemTitle</span><span class="p">:</span> <span class="n">new</span> <span class="n">Property</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">),</span>
    <span class="n">itemDescription</span><span class="p">:</span> <span class="p">{</span> <span class="n">Feature</span> <span class="n">f</span> <span class="o">-&gt;</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Schema</span><span class="p">(</span><span class="s2">&quot;points&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span> <span class="s2">&quot;Point&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;int&quot;</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">Workspace</span> <span class="n">workspace</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Memory</span><span class="p">()</span>
<span class="n">Layer</span> <span class="n">layer</span> <span class="o">=</span> <span class="n">workspace</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">withWriter</span> <span class="p">{</span> <span class="n">writer</span> <span class="o">-&gt;</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">feature</span><span class="p">([</span><span class="n">geom</span><span class="p">:</span> <span class="s2">&quot;POINT (1 1)&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Washington&quot;</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;The state of Washington&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;state.1&quot;</span><span class="p">))</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">feature</span><span class="p">([</span><span class="n">geom</span><span class="p">:</span> <span class="s2">&quot;POINT (2 2)&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Oregon&quot;</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;The state of Oregon&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;state.2&quot;</span><span class="p">))</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">feature</span><span class="p">([</span><span class="n">geom</span><span class="p">:</span> <span class="s2">&quot;POINT (3 3)&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;California&quot;</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="s2">&quot;The state of California&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;state.3&quot;</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">println</span> <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">createLayer</span><span class="p">())</span>
</pre></div>
</div>
</li>
<li><p>geoscript.layer.io.GeoJSONReader supports reading features that have different schemas</p></li>
<li><p>geoscript.feature.Feature now has getGeoJSON(), getGeoRSS(), getKml(), getGml() methods</p></li>
<li><p>Removed JDOM dependency with Groovy’s native XML support</p></li>
<li><p>Removed org.json dependency with GeoTools GeoJSON support</p></li>
</ul>
</div></blockquote>
<p><strong>Rendering</strong></p>
<blockquote>
<div><ul>
<li><p>Randomized Fill:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.Shapefile</span>
<span class="kn">import</span> <span class="nn">geoscript.render.Draw</span>
<span class="kn">import</span> <span class="nn">geoscript.style.</span><span class="o">*</span>

<span class="n">shp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">)</span>
<span class="n">shp</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="n">null</span><span class="p">)</span><span class="o">.</span><span class="n">hatch</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#aaaaaa&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">random</span><span class="p">:</span> <span class="s2">&quot;free&quot;</span><span class="p">,</span> <span class="n">symbolCount</span><span class="p">:</span> <span class="s2">&quot;50&quot;</span><span class="p">,</span> <span class="n">tileSize</span><span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;PERSONS &lt; 2000000&quot;</span><span class="p">))</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="n">null</span><span class="p">)</span><span class="o">.</span><span class="n">hatch</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#aaaaaa&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">random</span><span class="p">:</span> <span class="s2">&quot;free&quot;</span><span class="p">,</span> <span class="n">symbolCount</span><span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span> <span class="n">tileSize</span><span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;PERSONS BETWEEN 2000000 AND 4000000&quot;</span><span class="p">))</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="n">null</span><span class="p">)</span><span class="o">.</span><span class="n">hatch</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#aaaaaa&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">random</span><span class="p">:</span> <span class="s2">&quot;free&quot;</span><span class="p">,</span> <span class="n">symbolCount</span><span class="p">:</span> <span class="s2">&quot;700&quot;</span><span class="p">,</span> <span class="n">tileSize</span><span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;PERSONS &gt; 4000000&quot;</span><span class="p">))</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Label</span><span class="p">(</span><span class="nb">property</span><span class="p">:</span> <span class="s2">&quot;STATE_ABBR&quot;</span><span class="p">,</span> <span class="n">font</span><span class="p">:</span> <span class="n">new</span> <span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="p">:</span> <span class="s2">&quot;Times New Roman&quot;</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="mi">14</span><span class="p">))</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">halo</span><span class="p">(</span><span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;#FFFFFF&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">println</span> <span class="n">shp</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">sld</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">shp</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/randomized_fill.png" src="_images/randomized_fill.png" />
</li>
<li><p>Hatch can take fill and stroke:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hatch</span> <span class="n">hatch</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Hatch</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">),</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s2">&quot;wheat&quot;</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>geoscript.render.Draw now accepts an optional backgroundColor parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Symbolizer</span> <span class="n">sym</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Stroke</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">new</span> <span class="n">Fill</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">Geometry</span> <span class="n">geom</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">draw</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">sym</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.1</span><span class="p">),</span> <span class="n">size</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">],</span> <span class="nb">format</span><span class="p">:</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>geoscript.render.Map is updated and deprecated class have been removed. This was contributed by Scott Bortman.  Thanks Scott!</p></li>
</ul>
</div></blockquote>
<p><strong>API Updates</strong></p>
<blockquote>
<div><ul>
<li><p>GeometryCollections now have a slice method that takes a start index and an optional end index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.geom.</span><span class="o">*</span>
<span class="n">GeometryCollection</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Geometry</span><span class="o">.</span><span class="n">fromWKT</span><span class="p">(</span><span class="s2">&quot;MULTIPOINT ((1 1), (2 2), (3 3), (4 4), (5 5))&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;MULTIPOINT ((2 2), (3 3))&quot;</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">wkt</span>
</pre></div>
</div>
<p>When the end index is absent it defaults to the end of the collection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="s2">&quot;MULTIPOINT ((3 3), (4 4), (5 5))&quot;</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">wkt</span>
</pre></div>
</div>
<p>Both the start and end index may be negative:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="s2">&quot;MULTIPOINT ((3 3), (4 4), (5 5))&quot;</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">wkt</span>
<span class="k">assert</span> <span class="s2">&quot;MULTIPOINT ((2 2), (3 3))&quot;</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">wkt</span>
</pre></div>
</div>
</li>
<li><p>Get the angle between this Point and another Point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="mi">45</span> <span class="o">==</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getAngle</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="k">assert</span> <span class="o">-</span><span class="mi">135</span><span class="p">,</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getAngle</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">),</span> <span class="s2">&quot;degrees&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="mf">2.3561</span> <span class="o">==</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getAngle</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="s2">&quot;radians&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Get the azimuth between this Point and the other Point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="mf">44.75</span> <span class="o">==</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getAzimuth</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="k">assert</span> <span class="mf">135.24</span> <span class="o">==</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getAzimuth</span><span class="p">(</span><span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p>Fields now have a isGeometry() method.</p></li>
<li><p>You can set the values of a Feature by passing in a Map:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="n">price</span><span class="p">:</span> <span class="mf">1200.5</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Car&quot;</span><span class="p">])</span>

<span class="n">feature</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">price</span><span class="p">:</span> <span class="mf">12.2</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Book&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Or by passing in an existing Feature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Feature</span> <span class="n">feature</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">feature</span><span class="p">([</span><span class="n">geom</span><span class="p">:</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span><span class="o">-</span><span class="mi">49</span><span class="p">),</span> <span class="n">price</span><span class="p">:</span> <span class="mf">15.6</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Test&quot;</span><span class="p">])</span>
<span class="n">newFeature</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Schema now has a way to create new Features with default values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Feature</span> <span class="n">f</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">feature</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Schema can also create new Features from an existing Feature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Feature</span> <span class="n">f</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">feature</span><span class="p">(</span><span class="n">existingFeature</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>When a Schema creates a Feature, the default ID is now created by the GeoTools SimpleFeatureBuilder’s createDefaultFeatureId() method.</p></li>
</ul>
</div></blockquote>
<p><strong>Command line programs</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Add -Dorg.geotools.referencing.forceXY=true to all command line programs</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="id14">
<h2>1.2<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.2 release of GeoScript was built on Groovy 2.1.6, GeoTools 10.0, and Java Topology Suite 1.13.</p>
<p>The focus was on upgrading to a modern and supported version of Groovy and a few small features and bug fixes.</p>
<p><strong>Upgrades</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Upgrade to GeoTools 10</p></li>
<li><p>Upgrade to Groovy 2.1.6</p></li>
<li><p>Upgrade to GeoCSS 0.8.3</p></li>
</ul>
</div></blockquote>
<p><strong>Features</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>The geoscript.layer.io.Readers can now take optional projection, workspace, name parameters</p></li>
<li><p>The geoscript.layer.io.CsvReader and CsvWriter by default now encode Field type in the header but this can be disabled</p></li>
<li><p>Added a MultiLineString.polygonizeFull() method that returns a Map with polygons, cut edges, dangles, and invalid ring lines.</p></li>
<li><p>Added Schema.includeFields to create a new Schema from an existing Schema with a subset of fields</p></li>
</ul>
</div></blockquote>
<p><strong>Bug Fixes</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Fixed Cursor paging bug - it’s start and max not start and end</p></li>
<li><p>Fixed CsvReader bug couldn’t guess WKT when it was formatted without a space (“POINT(1 1)” instead of “POINT (1 1)”)</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="id15">
<h2>1.1.1<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.1.1 release of GeoScript Groovy just fixes a few minor bugs.</p>
<p><strong>Bug Fixes</strong></p>
<ul class="simple">
<li><p>Fixed Cursor paging bug - it’s start and max not start and end</p></li>
<li><p>Fixed CsvReader bug couldn’t guess WKT when it was formatted without a space (“POINT(1 1)” instead of “POINT (1 1)”)</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id16">
<h2>1.1<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.1 release of GeoScript was built on Groovy 1.8.9, GeoTools 9.x, and Java Topology Suite (JTS) 1.13</p>
<p>The focus was on adding a Raster support (geoscript.layer), Charting (geoscript.plot), and numerous bug fixes and small features.</p>
<p><strong>Raster</strong></p>
<blockquote>
<div><ul>
<li><p>Format (ArcGri, GeoTIFF, GTopo30, Grass, ImagePyramid, MrSID, WorldImage)</p>
<p>Formats allow you to read and write Rasters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.</span><span class="o">*</span>

<span class="k">def</span> <span class="nf">format</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">raster</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;raster.tif&quot;</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">format2</span> <span class="o">=</span> <span class="n">new</span> <span class="n">WorldImage</span><span class="p">()</span>
<span class="n">format2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;raster.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p>Raster:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.</span><span class="o">*</span>

<span class="k">def</span> <span class="nf">format</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">raster</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;raster.tif&quot;</span><span class="p">))</span>

<span class="n">println</span> <span class="n">raster</span><span class="o">.</span><span class="n">proj</span><span class="o">.</span><span class="n">id</span>
<span class="n">println</span> <span class="n">raster</span><span class="o">.</span><span class="n">bounds</span>
<span class="n">println</span> <span class="n">raster</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</li>
<li><p>Band:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.</span><span class="o">*</span>

<span class="k">def</span> <span class="nf">format</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">raster</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;raster.tif&quot;</span><span class="p">))</span>
<span class="n">raster</span><span class="o">.</span><span class="n">bands</span><span class="o">.</span><span class="n">eachWithIndex</span><span class="p">{</span><span class="n">b</span><span class="p">,</span><span class="n">i</span> <span class="o">-&gt;</span>
    <span class="n">println</span> <span class="s2">&quot;Band $</span><span class="si">{i}</span><span class="s2">:&quot;</span>
    <span class="n">println</span> <span class="s2">&quot;   Min: $</span><span class="si">{b.min}</span><span class="s2">&quot;</span>
    <span class="n">println</span> <span class="s2">&quot;   Max: $</span><span class="si">{b.max}</span><span class="s2">&quot;</span>
    <span class="n">println</span> <span class="s2">&quot;   NoData: $</span><span class="si">{b.noData}</span><span class="s2">&quot;</span>
    <span class="n">println</span> <span class="s2">&quot;   Unit: $</span><span class="si">{b.unit}</span><span class="s2">&quot;</span>
    <span class="n">println</span> <span class="s2">&quot;   Scale: $</span><span class="si">{b.scale}</span><span class="s2">&quot;</span>
    <span class="n">println</span> <span class="s2">&quot;   Offset: $</span><span class="si">{b.offset}</span><span class="s2">&quot;</span>
    <span class="n">println</span> <span class="s2">&quot;   Type: $</span><span class="si">{b.type}</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>MapAlgebra (which is powered by Jiffle):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.</span><span class="o">*</span>

<span class="k">def</span> <span class="nf">format</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">raster</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;raster.tif&quot;</span><span class="p">))</span>

<span class="n">Raster</span> <span class="n">rasterPlusTen</span> <span class="o">=</span> <span class="n">raster</span> <span class="o">+</span> <span class="mi">10</span>

<span class="n">MapAlgebra</span> <span class="n">algebra</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MapAlgebra</span><span class="p">()</span>
<span class="n">Raster</span> <span class="n">output</span> <span class="o">=</span> <span class="n">algebra</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="s2">&quot;dest = src &gt; 200;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">src</span><span class="p">:</span> <span class="n">raster</span><span class="p">],</span> <span class="n">size</span><span class="p">:</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Process</p>
<p>Raster support was added to the Process module (geoscript.process.Process) which opens up numerous geospatial algorithms like heatmap, barnes surface, and raster algebra.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Process</span> <span class="n">process</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Process</span><span class="p">(</span><span class="s2">&quot;vec:BarnesSurface&quot;</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">execute</span><span class="p">([</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">layer</span><span class="o">.</span><span class="n">cursor</span><span class="p">,</span>
    <span class="n">valueAttr</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span>
    <span class="n">scale</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">convergence</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="n">passes</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">minObservations</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">maxObservationDistance</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">pixelsPerCell</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">noDataValue</span><span class="p">:</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span>
    <span class="n">outputWidth</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">outputHeight</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">outputBBOX</span><span class="p">:</span> <span class="n">layer</span><span class="o">.</span><span class="n">bounds</span>
<span class="p">])</span>
<span class="n">Raster</span> <span class="n">raster</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
</li>
<li><p>Style</p>
<p>Raster specific Symbolizers were added to the geoscript.style module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">raster</span> <span class="o">=</span> <span class="n">new</span> <span class="n">RasterSymbolizer</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">channel</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ChannelSelection</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">colorMap</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ColorMap</span><span class="p">([[</span><span class="n">color</span><span class="p">:</span> <span class="s2">&quot;#008000&quot;</span><span class="p">,</span> <span class="n">quantity</span><span class="p">:</span><span class="mi">70</span><span class="p">],</span> <span class="p">[</span><span class="n">color</span><span class="p">:</span><span class="s2">&quot;#663333&quot;</span><span class="p">,</span> <span class="n">quantity</span><span class="p">:</span><span class="mi">256</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">c</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ContrastEnhancement</span><span class="p">(</span><span class="s2">&quot;histogram&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">shadedRelief</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ShadedRelief</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Rendering</p>
<p>The geoscript Rendering module (geoscript.render) now supports drawing Rasters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geoscript.layer.</span><span class="o">*</span>
<span class="kn">import</span> <span class="nn">geoscript.render.</span><span class="o">*</span>

<span class="k">def</span> <span class="nf">format</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GeoTIFF</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">raster</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;raster.tif&quot;</span><span class="p">))</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span>

<span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:[</span><span class="n">new</span> <span class="n">Shapefile</span><span class="p">(</span><span class="s2">&quot;states.shp&quot;</span><span class="p">),</span> <span class="n">raster</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">image</span> <span class="o">=</span> <span class="nb">map</span><span class="o">.</span><span class="n">drawToImage</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>Plot</strong></p>
<blockquote>
<div><ul>
<li><p>Chart</p>
<p>A Chart can be created by one of the factory classes (Bar, Box, Curve, Pie, Regression, and Scatter).Once created, you can display it as an interactive app, save it to a File, or save it to an Image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Chart</span> <span class="n">chart</span> <span class="o">=</span> <span class="n">Box</span><span class="o">.</span><span class="n">box</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s2">&quot;B&quot;</span><span class="p">:[</span><span class="mi">45</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="s2">&quot;C&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="s2">&quot;D&quot;</span><span class="p">:[</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">19</span><span class="p">]])</span>
<span class="n">chart</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">chart</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;bar.jpeg&quot;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">image</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">image</span>
</pre></div>
</div>
</li>
<li><p>Bar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Chart</span> <span class="n">chart</span> <span class="o">=</span> <span class="n">Bar</span><span class="o">.</span><span class="n">xy</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="mi">45</span><span class="p">,</span><span class="mi">12</span><span class="p">],[</span><span class="mi">23</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">]])</span>

<span class="n">Chart</span> <span class="n">chart</span> <span class="o">=</span> <span class="n">Bar</span><span class="o">.</span><span class="n">category</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">:</span><span class="mi">45</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">:</span><span class="mi">14</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Box:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Chart</span> <span class="n">chart</span> <span class="o">=</span> <span class="n">Box</span><span class="o">.</span><span class="n">box</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s2">&quot;B&quot;</span><span class="p">:[</span><span class="mi">45</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="s2">&quot;C&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="s2">&quot;D&quot;</span><span class="p">:[</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">19</span><span class="p">]])</span>
</pre></div>
</div>
</li>
<li><p>Curve:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Chart</span> <span class="n">chart</span> <span class="o">=</span> <span class="n">Curve</span><span class="o">.</span><span class="n">curve</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="mi">45</span><span class="p">,</span><span class="mi">12</span><span class="p">],[</span><span class="mi">23</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">]])</span>
</pre></div>
</div>
</li>
<li><p>Pie:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Chart</span> <span class="n">chart</span> <span class="o">=</span> <span class="n">Pie</span><span class="o">.</span><span class="n">pie</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">:</span><span class="mi">45</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">:</span><span class="mi">14</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Regression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">points</span> <span class="o">=</span> <span class="n">Geometry</span><span class="o">.</span><span class="n">createRandomPoints</span><span class="p">(</span><span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">List</span> <span class="n">data</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span><span class="n">pt</span> <span class="o">-&gt;</span>
    <span class="p">[</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Scatter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">points</span> <span class="o">=</span> <span class="n">Geometry</span><span class="o">.</span><span class="n">createRandomPoints</span><span class="p">(</span><span class="n">new</span> <span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">List</span> <span class="n">data</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span><span class="n">pt</span> <span class="o">-&gt;</span>
 <span class="p">[</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>General</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Include GroovyDocs in zip distribution</p></li>
</ul>
</div></blockquote>
<p><strong>Geometry</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>List&lt;Point&gt; getNearestPoints(Geometry other)</p></li>
<li><p>List&lt;Point&gt; getPoints()</p></li>
<li><p>Geometry smooth(double fit)</p></li>
<li><p>static Geometry cascadedUnion(List&lt;Polygon&gt; polygons)</p></li>
<li><p>static Geometry fromString(String str)</p></li>
</ul>
</div></blockquote>
<p><strong>Polygon &amp; MultiPolygon</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Geometry split(LineString lineString)</p></li>
<li><p>Geometry split(MultiLineString multiLineString)</p></li>
</ul>
</div></blockquote>
<p><strong>Schema</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>boolean has(def field)</p></li>
<li><p>Map addSchema(Map options = [:], Schema otherSchema, String newName)</p></li>
<li><p>Schema changeField(Field oldField, Field newField, String name)</p></li>
<li><p>Schema changeFields(Map&lt;Field, Field&gt; fieldsToChange, String name)</p></li>
<li><p>Schema addFields(List&lt;Field&gt; newFields, String name)</p></li>
<li><p>Schema addField(Field field, String name)</p></li>
<li><p>Schema removeField(Field field, String name)</p></li>
<li><p>Schema removeFields(List&lt;Field&gt; fieldsToRemove, String name)</p></li>
</ul>
</div></blockquote>
<p><strong>Layer</strong></p>
<blockquote>
<div><ul>
<li><p>Reproject features on the fly when using a Cursor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cursor</span> <span class="n">c</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">getCursor</span><span class="p">(</span><span class="n">destProj</span><span class="p">:</span> <span class="s2">&quot;EPSG:2927&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Set source projection when reprojecting Layers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">layer2</span> <span class="o">=</span> <span class="n">layer1</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;EPSG:2927&quot;</span><span class="p">),</span> <span class="s2">&quot;projected_facilties&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">new</span> <span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p>Add a List of Maps to a Layer inside of a Transaction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layer1</span><span class="o">.</span><span class="n">add</span><span class="p">([</span>
    <span class="p">[</span><span class="n">geom</span><span class="p">:</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">),</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Point 1&quot;</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">geom</span><span class="p">:</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="o">-</span><span class="mi">46</span><span class="p">),</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Point 2&quot;</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">geom</span><span class="p">:</span> <span class="n">new</span> <span class="n">Point</span><span class="p">(</span><span class="mi">102</span><span class="p">,</span><span class="o">-</span><span class="mi">47</span><span class="p">),</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Point 3&quot;</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">],</span>
<span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Layer.transform using gt-transform module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">layer2</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">&quot;buffered_facilities&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="n">geom</span><span class="p">:</span> <span class="s2">&quot;buffer(geom, 10)&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;strToUpperCase(name)&quot;</span><span class="p">,</span>
    <span class="n">price</span><span class="p">:</span> <span class="s2">&quot;price * 10&quot;</span>
<span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>geoscript.layer.Property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Property</span> <span class="n">prop</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Property</span><span class="p">(</span><span class="s1">&#39;states.properties&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Feature first(Map options = [:])</p></li>
<li><p>Layer.update can take an Expression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">),</span> <span class="n">Expression</span><span class="o">.</span><span class="n">fromCQL</span><span class="p">(</span><span class="s2">&quot;price * 2&quot;</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p>Layer.update(groovy script):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="s2">&quot;return c + &#39;). &#39; + f.get(&#39;name&#39;)&quot;</span><span class="p">,</span> <span class="n">Filter</span><span class="o">.</span><span class="n">PASS</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Layer reproject(Projection p, Workspace outputWorkspace, String newName, int chunk=1000, Projection sourceProjection = new Projection(“EPSG:4326”))</p>
<p>Reproject a Layer to another Layer in the given Workspace</p>
</li>
<li><p>Layer reproject(Layer projectedLayer, int chunk = 1000, Projection sourceProjection = new Projection(“EPSG:4326”))</p>
<p>Reproject a Layer to another Layer that already exists.</p>
</li>
<li><p>Layer getCursor(fields:[]):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span><span class="o">.</span><span class="n">getCursor</span><span class="p">([</span><span class="n">fields</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>Layer IO</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>KmlReader and KmlWriter</p></li>
</ul>
</div></blockquote>
<p><strong>Filter</strong></p>
<blockquote>
<div><ul>
<li><p>Filter getNot():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new</span> <span class="n">Filter</span><span class="p">(</span><span class="s2">&quot;name=&#39;foo&#39;).not == new Filter(&quot;</span><span class="n">name</span><span class="o">&lt;&gt;</span><span class="s1">&#39;foot&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Filter.simplify()</p></li>
</ul>
</div></blockquote>
<p><strong>Expression</strong></p>
<blockquote>
<div><ul>
<li><p>Object evaluate(Object obj = null):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Expression</span> <span class="n">e</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Expression</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">assertEquals</span> <span class="mi">12</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>Bounds</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>void setProj(def projection)</p></li>
<li><p>static Bounds fromString(String str)</p></li>
<li><p>Bounds fixAspectRatio(int w, int h)</p></li>
<li><p>boolean contains(Bounds other)</p></li>
<li><p>double getAspect()</p></li>
<li><p>Geometry getGrid(int columns, int rows, String type = “polygon”)</p></li>
<li><p>Geometry getGrid(double cellWidth, double cellHeight, String type = “polygon”)</p></li>
<li><p>void generateGrid(int columns, int rows, String type, Closure c)</p></li>
<li><p>void generateGrid(double cellWidth, double cellHeight, String type, Closure c)</p></li>
</ul>
</div></blockquote>
<p><strong>WMS</strong></p>
<blockquote>
<div><ul>
<li><p>WMS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WMS</span> <span class="n">wms</span> <span class="o">=</span> <span class="n">new</span> <span class="n">WMS</span><span class="p">(</span><span class="s2">&quot;http://localhost:8080/geoserver/ows?service=wms&amp;version=1.1.1&amp;request=GetCapabilities&quot;</span><span class="p">)</span>
<span class="n">println</span> <span class="s2">&quot;Name: $</span><span class="si">{wms.name}</span><span class="s2">&quot;</span>
<span class="n">println</span> <span class="s2">&quot;Title: $</span><span class="si">{wms.title}</span><span class="s2">&quot;</span>
<span class="k">def</span> <span class="nf">image</span> <span class="o">=</span> <span class="n">wms</span><span class="o">.</span><span class="n">getImage</span><span class="p">(</span><span class="s2">&quot;world:borders&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>WMSLayer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WMS</span> <span class="n">wms</span> <span class="o">=</span> <span class="n">new</span> <span class="n">WMS</span><span class="p">(</span><span class="s2">&quot;http://localhost:8080/geoserver/ows?service=wms&amp;version=1.1.1&amp;request=GetCapabilities&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">geoscript</span><span class="o">.</span><span class="n">render</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">new</span> <span class="n">WMSLayer</span><span class="p">(</span><span class="n">wms</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;world:borders&quot;</span><span class="p">,</span><span class="s2">&quot;world:cities&quot;</span><span class="p">])]</span>
<span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">&quot;map_world.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>Workspace</strong></p>
<blockquote>
<div><ul>
<li><p>WFS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">wfs</span> <span class="o">=</span> <span class="n">new</span> <span class="n">WFS</span><span class="p">(</span><span class="s2">&quot;http://localhost:8080/geoserver/ows?service=wfs&amp;version=1.1.0&amp;request=GetCapabilities&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="mi">9000</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>H2 constructor with database file instead of directory</p></li>
</ul>
</div></blockquote>
<p><strong>Render</strong></p>
<blockquote>
<div><ul>
<li><p>GIF</p>
<p>Image subclass that includes animated GIF support!:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">],</span> <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">GIF</span> <span class="n">gif</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GIF</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">img</span> <span class="o">=</span> <span class="n">gif</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>

<span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">],</span> <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">GIF</span> <span class="n">gif</span> <span class="o">=</span> <span class="n">new</span> <span class="n">GIF</span><span class="p">()</span>
<span class="n">List</span> <span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;WA&quot;</span><span class="p">,</span><span class="s2">&quot;OR&quot;</span><span class="p">,</span><span class="s2">&quot;CA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span><span class="n">state</span> <span class="o">-&gt;</span>
  <span class="nb">map</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">(</span><span class="s2">&quot;STATE_ABBR = &#39;$</span><span class="si">{state}</span><span class="s2">&#39;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bounds</span>
  <span class="k">def</span> <span class="nf">image</span> <span class="o">=</span> <span class="n">gif</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
  <span class="n">image</span>
<span class="p">}</span>
<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">File</span><span class="o">.</span><span class="n">createTempFile</span><span class="p">(</span><span class="s2">&quot;image_&quot;</span><span class="p">,</span><span class="s2">&quot;.gif&quot;</span><span class="p">)</span>
<span class="n">gif</span><span class="o">.</span><span class="n">renderAnimated</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>PNG:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">],</span> <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">PNG</span> <span class="n">png</span> <span class="o">=</span> <span class="n">new</span> <span class="n">PNG</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">img</span> <span class="o">=</span> <span class="n">png</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>JPEG:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">layers</span><span class="p">:</span> <span class="p">[</span><span class="n">layer</span><span class="p">],</span> <span class="n">backgroundColor</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">JPEG</span> <span class="n">jpeg</span> <span class="o">=</span> <span class="n">new</span> <span class="n">JPEG</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">img</span> <span class="o">=</span> <span class="n">jpeg</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="id17">
<h2>1.0<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The 1.0 release of GeoScript was built on Groovy 1.8.8, GeoTools 8.x and Java Topology Suite (JTS) 1.12.</p>
<p>The focus was the following modules:</p>
<blockquote>
<div><ul class="simple">
<li><p>Geometry (geoscript.geom)</p></li>
<li><p>Projection (geoscript.proj)</p></li>
<li><p>Vector Layers (geoscript.feature, geoscript.layer, geoscript.workspace)</p></li>
<li><p>Rendering (geoscript.viewer, geoscript.style, geoscript.render)</p></li>
<li><p>Process (geoscript.process)</p></li>
<li><p>Spatial Index (geoscript.index)</p></li>
<li><p>Expressions (geoscript.filter)</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
            <li class="right" style="margin-right: 10px">
              <a href="genindex.html" title="General Index"
                 accesskey="I">index</a></li>
            <li class="right" >
              <a href="mavenapp.html" title="Maven Quickstart"
                 accesskey="N">next</a> |</li>
            <li class="right" >
              <a href="download.html" title="Downloads"
                 accesskey="P">previous</a> |</li>
        <li><a href="index.html">GeoScript Groovy</a> &#187;</li>
        <li><a href="#">GeoScript Groovy Releases</a></li>
      </ul>
    </div>

<div class="footer">
    <a rel="license" href="https://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/3.0/us/80x15.png" /></a>
      &copy; Copyright 2020, Jared Erickson.
</div>

  </body>
</html>